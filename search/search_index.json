{"config": {"lang": ["en"], "separator": "[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+", "pipeline": ["stemmer"]}, "docs": [{"location": "", "title": "\u9996\u9875", "text": ""}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/", "title": "openstack-heat", "text": "<p>\u5b98\u65b9\u6587\u6863</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#openstack-heatopenstack-heat", "title": "OpenStack Heat\u6a21\u677f\u7684\u7248\u672c\u53f7\uff0c\u786e\u4fdd\u4e0eOpenStack Heat\u670d\u52a1\u517c\u5bb9", "text": "<p>heat_template_version: 2015-10-15</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#_1", "title": "\u6a21\u677f\u7684\u63cf\u8ff0", "text": "<p>description: Launch a basic instance with CirrOS image using the              \"m1.tiny\" flavor, \"mykey\" key, and one network.</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#_2", "title": "\u5b9a\u4e49\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u5728\u521b\u5efa\u5806\u6808\u65f6\u63d0\u4f9b\u503c", "text": "<p>parameters:   ## \u7f51\u7edcID\uff0c\u7528\u4e8e\u5b9e\u4f8b\u7684\u7f51\u7edc\u8bbe\u7f6e   NetID:     type: string     description: Network ID to use for the instance.</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#openstack", "title": "\u5b9a\u4e49\u8d44\u6e90\uff0c\u8fd9\u4e9b\u8d44\u6e90\u5c06\u5728OpenStack\u4e2d\u521b\u5efa", "text": "<p>resources:   ## \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3aserver\u7684\u8d44\u6e90\uff0c\u5b83\u7684\u7c7b\u578b\u662fOS::Nova::Server   ## \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2aNova\u670d\u52a1\u5668\u5b9e\u4f8b   server:     type: OS::Nova::Server     # \u8d44\u6e90\u7684\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u5c06\u5728\u521b\u5efa\u5b9e\u4f8b\u65f6\u4f7f\u7528     properties:       # \u7528\u4e8e\u521b\u5efa\u5b9e\u4f8b\u7684\u955c\u50cf\uff0c\u8fd9\u91cc\u6307\u5b9a\u4e3aCirrOS\u955c\u50cf       image: cirros       # \u7528\u4e8e\u521b\u5efa\u5b9e\u4f8b\u7684\u865a\u62df\u673a\u7c7b\u578b\uff0c\u8fd9\u91cc\u6307\u5b9a\u4e3am1.tiny       flavor: m1.tiny       # \u7528\u4e8e\u5b9e\u4f8b\u7684\u5bc6\u94a5\u5bf9\uff0c\u8fd9\u91cc\u6307\u5b9a\u4e3amykey       key_name: mykey       # \u5b9e\u4f8b\u5c06\u8fde\u63a5\u5230\u7684\u7f51\u7edc\u5217\u8868\uff0c\u8fd9\u91cc\u4f7f\u7528NetID\u53c2\u6570\u63d0\u4f9b\u7684\u7f51\u7edcID       networks:         - network: { get_param: NetID }</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#_3", "title": "\u5b9a\u4e49\u8f93\u51fa\uff0c\u8fd9\u4e9b\u8f93\u51fa\u5c06\u5728\u521b\u5efa\u5806\u6808\u540e\u63d0\u4f9b\u503c", "text": "<p>outputs:   ## \u8f93\u51fa\u5b9e\u4f8b\u7684\u540d\u79f0   instance_name:     description: Name of the instance.     value: { get_attr: [ server, name ] }   ## \u8f93\u51fa\u5b9e\u4f8b\u7684IP\u5730\u5740   instance_ip:     description: IP address of the instance.     value: { get_attr: [ server, first_address ] }</p> <p>\u4ee5\u4e0b\u662f\u5404\u79cd\u8d44\u6e90\u7684\u521b\u5efa\u6a21\u677f</p> <p>Nova Resources\uff1a OS::Nova::Server\uff1a\u521b\u5efa\u865a\u62df\u673a\u5b9e\u4f8b\u3002</p> <p>heat_template_version: 2014-10-16    2013-05-23 </p> <p>resources:   my_vm:     type: OS::Nova::Server     properties:       image: \"your_image_id\"       flavor: \"your_flavor_id\"       key_name: \"your_keypair_name\"</p> <p>openstack orchestration resource type list   \u67e5\u770b\u8d44\u6e90\u7c7b\u578b</p> <p>OS::Nova::Flavor\uff1a\u521b\u5efa\u865a\u62df\u673a\u5b9e\u4f8b\u7c7b\u578b\u3002</p> <p>heat_template_version: 2014-10-16</p> <p>resources:   my_custom_flavor:     type: OS::Nova::Flavor     properties:       disk: 20           20G\u786c\u76d8         ram: 4096           4G\u5185\u5b58       swap: 0           \u4ea4\u6362\u5206\u533a\u5927\u5c0f       vcpus: 2               2\u4e2acpu</p> <p>OS::Nova::Keypair\uff1a\u521b\u5efa\u5bc6\u94a5\u5bf9\u3002 heat_template_version: 2014-10-16</p> <p>resources:   my_keypair:     type: OS::Nova::Keypair     properties:       name: my-heat-keypair       save_private_key: true</p> <p>OS::Nova::SecurityGroup\uff1a\u521b\u5efa\u5b89\u5168\u7ec4\u3002 heat_template_version: 2014-10-16</p> <p>resources:   my_security_group:     type: OS::Neutron::SecurityGroup     properties:       name: my-heat-security-group       rules:          \u5b89\u5168\u7ec4\u89c4\u5219\u5217\u8868         - protocol: tcp              \u6307\u5b9a\u89c4\u5219\u7684\u534f\u8bae\u7c7b\u578b\u3002\u8fd9\u91cc\u8bbe\u7f6e\u4e3a tcp           port_range_min: 22   \u89c4\u5219\u5141\u8bb8\u7684\u7aef\u53e3\u7684\u8d77\u59cb\u8303\u56f4\u8fd9\u91cc\u8bbe\u7f6e\u4e3a 22\u8868\u793a\u89c4\u5219\u7684\u7aef\u53e3\u8303\u56f4\u4ece 22 \u7aef\u53e3\u5f00\u59cb\u3002           port_range_max: 22  \u89c4\u5219\u5141\u8bb8\u7684\u7aef\u53e3\u7684\u7ed3\u675f\u8303\u56f4\u3002\u8fd9\u91cc\u540c\u6837\u8bbe\u7f6e\u4e3a 22\uff0c\u4e0e port_range_min \u76f8\u540c\uff0c\u8868\u793a\u53ea\u5141\u8bb8\u5355\u4e2a\u7aef\u53e3 22           remote_ip_prefix: 0.0.0.0/0  \u8fd9\u610f\u5473\u7740\u6ca1\u6709 IP \u5730\u5740\u9650\u5236\uff0c\u4efb\u4f55\u5730\u65b9\u7684\u4efb\u4f55\u4eba\u90fd\u80fd\u591f\u5c1d\u8bd5\u901a\u8fc7 SSH \u8fde\u63a5\u5230\u8bbe\u7f6e\u4e86\u8be5\u5b89\u5168\u7ec4\u7684\u865a\u62df\u673a\u5b9e\u4f8b</p> <p>OS::Nova::VolumeAttachment\uff1a\u5c06\u5377\u9644\u52a0\u5230\u865a\u62df\u673a\u5b9e\u4f8b\u3002 Neutron Resources\uff1a OS::Neutron::Net\uff1a\u521b\u5efa\u7f51\u7edc\u3002 OS::Neutron::Subnet\uff1a\u521b\u5efa\u5b50\u7f51\u3002 heat_template_version: 2013-05-23     \u7f51\u7edc\u4e0e\u5b50\u7f51\u7ed3\u5408</p> <p>resources:   HeatNetwork:     type: OS::Neutron::Net     properties:       name: Heat-Network       shared: false   \u6307\u5b9a\u7f51\u7edc\u662f\u5426\u5171\u4eab\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a\u4e0d\u5171\u4eab</p> <p>HeatSubnet:     type: OS::Neutron::Subnet     properties:       network_id: { get_resource: HeatNetwork }       name: Heat-Subnet     \u5b50\u7f51\u7684\u540d\u79f0       cidr: 10.20.2.0/24   IP \u5730\u5740\u8303\u56f4       enable_dhcp: true   \u6307\u5b9a\u662f\u5426\u542f\u7528 DHCP \u670d\u52a1       allocation_pools:      \u5b9a\u4e49 IP \u5730\u5740\u5206\u914d\u6c60\uff0c\u5373 DHCP \u670d\u52a1\u5668\u5206\u914d\u7684 IP \u5730\u5740\u8303\u56f4         - start: 10.20.2.20    \u8d77\u59cb\u5730\u5740           end: 10.20.2.100    \u7ed3\u675f\u5730\u5740       gateway_ip: 10.20.2.1   \u7f51\u5173</p> <p>OS::Neutron::Router\uff1a\u521b\u5efa\u8def\u7531\u5668\u3002 heat_template_version: 2014-10-16</p> <p>resources:   my_network:     type: OS::Neutron::Net     properties:       name: my-heat-network       admin_state_up: true</p> <p>my_subnet:     type: OS::Neutron::Subnet     properties:       network_id: { get_resource: my_network }       cidr: 10.0.0.0/24       ip_version: 4       name: my-heat-subnet</p> <p>my_router:     type: OS::Neutron::Router     properties:       name: my-heat-router       external_gateway_info:         network: public       # Replace 'public' with the actual name or ID of the external network</p> <p>router_interface:     type: OS::Neutron::RouterInterface     properties:       router_id: { get_resource: my_router }       subnet_id: { get_resource: my_subnet }</p> <p>OS::Neutron::Port\uff1a\u521b\u5efa\u7f51\u7edc\u7aef\u53e3\u3002 OS::Neutron::FloatingIP\uff1a\u521b\u5efa\u6d6e\u52a8IP\u3002 heat_template_version: 2014-10-16</p> <p>resources:   my_floating_ip:     type: OS::Neutron::FloatingIP     properties:       pool: public       # \u6307\u5b9a\u6d6e\u52a8IP\u6240\u5728\u7684\u5730\u5740\u6c60\uff0c\u8fd9\u91cc\u4f7f\u7528\u9ed8\u8ba4\u7684 'public' \u5730\u5740\u6c60</p> <p>Cinder Resources\uff1a OS::Cinder::Volume\uff1a\u521b\u5efa\u5377\u3002 heat_template_version: 2014-10-16</p> <p>resources:   my_volume:     type: OS::Cinder::Volume     properties:       size: 1       # \u6307\u5b9a\u5377\u7684\u5927\u5c0f\uff08GB\uff09       volume_type: None       # \u6307\u5b9a\u5377\u7684\u7c7b\u578b\uff0c\u8fd9\u91cc\u4f7f\u7528\u9ed8\u8ba4\u7c7b\u578b       snapshot_id: None       # \u6307\u5b9a\u5377\u7684\u5feb\u7167ID\uff0c\u8fd9\u91cc\u4f7f\u7528None\uff0c\u8868\u793a\u521b\u5efa\u4e00\u4e2a\u65b0\u5377\u800c\u4e0d\u662f\u4ece\u5feb\u7167\u521b\u5efa       source_volid: None       # \u6307\u5b9a\u6e90\u5377ID\uff0c\u8fd9\u91cc\u4f7f\u7528None\uff0c\u8868\u793a\u521b\u5efa\u4e00\u4e2a\u65b0\u5377\u800c\u4e0d\u662f\u4ece\u6e90\u5377\u590d\u5236       source_replica: None       # \u6307\u5b9a\u6e90\u590d\u5236\u7684ID\uff0c\u8fd9\u91cc\u4f7f\u7528None\uff0c\u8868\u793a\u521b\u5efa\u4e00\u4e2a\u65b0\u5377\u800c\u4e0d\u662f\u4ece\u6e90\u590d\u5236\u521b\u5efa       description: my-heat-volume       # \u6307\u5b9a\u5377\u7684\u63cf\u8ff0\u4fe1\u606f</p> <p>OS::Cinder::Snapshot\uff1a\u521b\u5efa\u5377\u5feb\u7167\u3002 OS::Cinder::VolumeAttachment\uff1a\u5c06\u5377\u9644\u52a0\u5230\u865a\u62df\u673a\u5b9e\u4f8b\u3002 Glance Resources\uff1a OS::Glance::Image\uff1a\u521b\u5efa\u955c\u50cf\u3002 heat_template_version: 2014-10-16</p> <p>resources:   my_image:     type: OS::Glance::Image     properties:       name: my-heat-image       # \u6307\u5b9a\u955c\u50cf\u7684\u540d\u79f0       visibility: public       # \u6307\u5b9a\u955c\u50cf\u7684\u53ef\u89c1\u6027\uff0c\u53ef\u4ee5\u662f public \u6216 private       disk_format: qcow2       # \u6307\u5b9a\u955c\u50cf\u7684\u78c1\u76d8\u683c\u5f0f\uff0c\u4f8b\u5982 qcow2 \u6216 vhd       container_format: bare       # \u6307\u5b9a\u955c\u50cf\u7684\u5bb9\u5668\u683c\u5f0f\uff0c\u4f8b\u5982 bare \u6216 ovf       min_disk: 0       # \u6307\u5b9a\u955c\u50cf\u542f\u52a8\u6240\u9700\u7684\u6700\u5c0f\u78c1\u76d8\u5927\u5c0f\uff08GB\uff09       min_ram: 0       # \u6307\u5b9a\u955c\u50cf\u542f\u52a8\u6240\u9700\u7684\u6700\u5c0f\u5185\u5b58\u5927\u5c0f\uff08MB\uff09       protected: false       # \u6307\u5b9a\u955c\u50cf\u662f\u5426\u53d7\u4fdd\u62a4\uff0c\u4e0d\u80fd\u88ab\u5220\u9664</p> <p>Keystone Resources\uff1a OS::Keystone::User\uff1a\u521b\u5efa\u7528\u6237\u3002 heat_template_version: 2013-05-23</p> <p>resources:   my_user:     type: OS::Keystone::User     properties:       name: my-heat-user       # \u6307\u5b9a\u7528\u6237\u7684\u540d\u79f0       password: my-password       # \u6307\u5b9a\u7528\u6237\u7684\u5bc6\u7801       email: my-email@example.com       # \u6307\u5b9a\u7528\u6237\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740       enabled: true       # \u6307\u5b9a\u7528\u6237\u662f\u5426\u542f\u7528\uff0c\u9ed8\u8ba4\u662f true       domain: demo OS::Keystone::Project\uff1a\u521b\u5efa\u9879\u76ee\u3002 heat_template_version: 2013-05-23</p> <p>resources:   my_project:     type: OS::Keystone::Project     properties:       name: my-heat-project       # \u6307\u5b9a\u9879\u76ee\u7684\u540d\u79f0       description: My project description       # \u6307\u5b9a\u9879\u76ee\u7684\u63cf\u8ff0\u4fe1\u606f       domain: default       # \u6307\u5b9a\u9879\u76ee\u6240\u5c5e\u7684\u57df\uff08domain\uff09</p> <p>OS::Keystone::Domain\uff1a\u521b\u5efa\u57df\u3002 heat_template_version: 2013-05-23</p> <p>resources:   my_domain:     type: OS::Keystone::Domain     properties:       name: my-heat-domain       # \u6307\u5b9a\u57df\u7684\u540d\u79f0       description: My domain description       # \u6307\u5b9a\u57df\u7684\u63cf\u8ff0\u4fe1\u606f</p> <p>OS::Keystone::Role\uff1a\u521b\u5efa\u89d2\u8272\u3002 heat_template_version: 2013-05-23</p> <p>resources:   my_role:     type: OS::Keystone::Role     properties:       name: my-heat-role       # \u6307\u5b9a\u89d2\u8272\u7684\u540d\u79f0       description: My role description       # \u6307\u5b9a\u89d2\u8272\u7684\u63cf\u8ff0\u4fe1\u606f</p> <p>OS::Keystone::Service\uff1a\u521b\u5efa\u670d\u52a1\u3002 heat_template_version: 2013-05-23</p> <p>resources:   my_service:     type: OS::Keystone::Service     properties:       name: my-heat-service       # \u6307\u5b9a\u670d\u52a1\u7684\u540d\u79f0       description: My service description       # \u6307\u5b9a\u670d\u52a1\u7684\u63cf\u8ff0\u4fe1\u606f       domain: default       # \u6307\u5b9a\u670d\u52a1\u6240\u5c5e\u7684\u57df\uff08domain\uff09       type: identity       # \u6307\u5b9a\u670d\u52a1\u7684\u7c7b\u578b\uff0c\u8fd9\u91cc\u662f\u8eab\u4efd\u9a8c\u8bc1\uff08identity\uff09</p> <p>OS::Keystone::Endpoint\uff1a\u521b\u5efa\u7aef\u70b9\u3002 Swift Resources: OS::Swift::Container \u521b\u5efa\u5bb9\u5668 heat_template_version: 2013-05-23</p> <p>resources:   my_container:     type: OS::Swift::Container     properties:       name: my-heat-container       # \u6307\u5b9a\u5bb9\u5668\u7684\u540d\u79f0       description: My container description       # \u6307\u5b9a\u5bb9\u5668\u7684\u63cf\u8ff0\u4fe1\u606f</p> <p>OS::Swift::Object       \u521b\u5efa\u5bf9\u8c61 heat_template_version: 2013-05-23</p> <p>resources:   my_object:     type: OS::Swift::Object     properties:       container: my-heat-container       # \u6307\u5b9a\u5bf9\u8c61\u5c06\u88ab\u4e0a\u4f20\u5230\u7684\u5bb9\u5668\u540d\u79f0       content:         # \u6307\u5b9a\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u3001base64\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u6216\u8005\u662f\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84         # \u4f8b\u5982\uff0c\u5982\u679c\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 get_file \u51fd\u6570         # content:         #   get_file: /path/to/file         # \u6216\u8005\uff0c\u5982\u679c\u4f60\u6709\u6587\u4ef6\u5185\u5bb9\u4f5c\u4e3a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u4f7f\u7528 get_attr \u51fd\u6570         # content:         #   get_attr: [my_container, content]         # \u6ce8\u610f\uff1a\u8fd9\u91cc\u9700\u8981\u786e\u4fdd content \u90e8\u5206\u7684\u5185\u5bb9\u662f\u4e00\u4e2a\u6709\u6548\u7684 Swift \u5bf9\u8c61\u5185\u5bb9       content_type: text/plain       # \u6307\u5b9a\u5bf9\u8c61\u7684 MIME \u7c7b\u578b       name: my-heat-object       # \u6307\u5b9a\u5bf9\u8c61\u7684\u540d\u79f0</p> <p>OS::Swift::Account    \u521b\u5efa\u8d26\u6237 \u8fd9\u4e9b\u8d44\u6e90\u7c7b\u578b\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff0c\u4ee5\u521b\u5efa\u590d\u6742\u7684\u5806\u6808\u914d\u7f6e\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Nova\u548cNeutron\u8d44\u6e90\u6765\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u7279\u5b9a\u7f51\u7edc\u914d\u7f6e\u7684\u865a\u62df\u673a\u5b9e\u4f8b\u5806\u6808\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u4e0d\u540c\u7684OpenStack\u7248\u672c\u53ef\u80fd\u4f1a\u652f\u6301\u4e0d\u540c\u7684\u8d44\u6e90\u7c7b\u578b\u3002\u5982\u679c\u4f60\u7684Heat\u6a21\u677f\u4e0e\u4f60\u7684OpenStack\u7248\u672c\u4e0d\u517c\u5bb9\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u66f4\u65b0\u6a21\u677f\u4ee5\u4f7f\u7528\u65b0\u7684\u8d44\u6e90\u7c7b\u578b\u6216\u4fee\u590d\u4efb\u4f55\u4e0d\u517c\u5bb9\u7684\u95ee\u9898\u3002</p> <p>\u7f16\u5199Heat\u6a21\u677fcreate_network.yaml,\u521b\u5efa\u540d\u4e3aHeat-Network\u7f51\u7edc,\u9009\u62e9\u4e0d\u5171\u4eab;\u521b\u5efa\u5b50\u7f51\u540d\u4e3aHeat-Subnet,\u5b50\u7f51\u7f51\u6bb5\u8bbe\u7f6e\u4e3a10.20.2.0/24,\u5f00\u542fDHCP\u670d\u52a1,\u5730\u5740\u6c60\u4e3a10.20.2.20-10.20.2.100</p> <p>heat_template_version: 2013-05-23  </p> <p>resources:   HeatNetwork:     type: OS::Neutron::Net     properties:       name: Heat-Network       shared: false   \u6307\u5b9a\u7f51\u7edc\u662f\u5426\u5171\u4eab\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a\u4e0d\u5171\u4eab</p> <p>HeatSubnet:     type: OS::Neutron::Subnet     properties:       network_id: { get_resource: HeatNetwork }       name: Heat-Subnet     \u5b50\u7f51\u7684\u540d\u79f0       cidr: 10.20.2.0/24   IP \u5730\u5740\u8303\u56f4       enable_dhcp: true   \u6307\u5b9a\u662f\u5426\u542f\u7528 DHCP \u670d\u52a1       allocation_pools:      \u5b9a\u4e49 IP \u5730\u5740\u5206\u914d\u6c60\uff0c\u5373 DHCP \u670d\u52a1\u5668\u5206\u914d\u7684 IP \u5730\u5740\u8303\u56f4         - start: 10.20.2.20    \u8d77\u59cb\u5730\u5740           end: 10.20.2.100    \u7ed3\u675f\u5730\u5740       gateway_ip: 10.20.2.1   \u7f51\u5173</p> <p>\u7f16\u5199 Heat \u6a21\u677fcreate_flavor.yaml\uff0c\u521b\u5efa\u540d\u4e3a\u201cm2.flavor\u201d\u3001ID \u4e3a 1234\u3001\u5185\u5b58\u4e3a 1024MB\u3001\u786c\u76d8\u4e3a 20GB\u3001vcpu\u6570\u91cf\u4e3a 1 \u7684\u4e91\u4e3b\u673a\u7c7b\u578b</p> <p>heat_template_version: 2013-05-23 resources: my_custom_flavor: type: OS::Nova::Flavor properties: name: m2.flavor flavorid: \"1234\" ram: 1024 disk: 20 vcpus: 1</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#openstack-heatopenstack-heat_1", "title": "OpenStack Heat\u6a21\u677f\u7684\u7248\u672c\u53f7\uff0c\u786e\u4fdd\u4e0eOpenStack Heat\u670d\u52a1\u517c\u5bb9", "text": "<p>heat_template_version: 2016-04-08</p>"}, {"location": "openstack/heat%E6%A8%A1%E6%9D%BF/#openstack_1", "title": "\u5b9a\u4e49\u8d44\u6e90\uff0c\u8fd9\u4e9b\u8d44\u6e90\u5c06\u5728OpenStack\u4e2d\u521b\u5efa", "text": "<p>resources:   ## \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3achinaskills\u7684\u8d44\u6e90\uff0c\u5b83\u7684\u7c7b\u578b\u662fOS::Keystone::Domain   ## \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2aKeystone\u57df   chinaskills:     type: OS::Keystone::Domain     properties:       # \u57df\u7684\u540d\u79f0       name: chinaskills</p> <p>## \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3abeijing_group\u7684\u8d44\u6e90\uff0c\u5b83\u7684\u7c7b\u578b\u662fOS::Keystone::Project   ## \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2aKeystone\u9879\u76ee   beijing_group:     type: OS::Keystone::Project     properties:       # \u9879\u76ee\u7684\u540d\u79f0 \u200b      name: beijing_group       # \u9879\u76ee\u6240\u5c5e\u7684\u57df\uff0c\u8fd9\u91cc\u901a\u8fc7get_resource\u51fd\u6570\u5f15\u7528chinaskills\u57df \u200b      domain: { get_resource: chinaskills }</p> <p>## \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3acloud\u7684\u8d44\u6e90\uff0c\u5b83\u7684\u7c7b\u578b\u662fOS::Keystone::User   ## \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2aKeystone\u7528\u6237   cloud:     type: OS::Keystone::User     properties:       # \u7528\u6237\u7684\u540d\u79f0       name: cloud       # \u7528\u6237\u6240\u5c5e\u7684\u57df\uff0c\u8fd9\u91cc\u901a\u8fc7get_resource\u51fd\u6570\u5f15\u7528chinaskills\u57df       domain: { get_resource: chinaskills }       # \u7528\u6237\u7684\u5bc6\u7801       password: 000000       # \u7528\u6237\u7684\u9ed8\u8ba4\u9879\u76ee\uff0c\u8fd9\u91cc\u901a\u8fc7get_resource\u51fd\u6570\u5f15\u7528beijing_group\u9879\u76ee       default_project: { get_resource: beijing_group }</p>"}, {"location": "openstack%20api/create_flavor/", "title": "flavor", "text": "<p>\u521b\u5efaflavor</p> <pre><code>import json\nimport requests\n\n\ndef auth():\n    auth_url = \"http://192.168.100.10:5000/v3/auth/tokens\"\n    auth_data = {\n        \"auth\": {\n            \"identity\": {\n                \"methods\": [\"password\"],\n                \"password\": {\n                    \"user\": {\n                        \"name\": 'admin',\n                        \"domain\": {\"name\": 'demo'},\n                        \"password\": '000000'\n                    }\n                }\n            },\n            \"scope\": {\n                \"project\": {\n                    \"name\": 'admin',\n                    \"domain\": {\n                        \"name\": 'demo'\n                    }\n                }\n            }\n        }\n    }\n    headers = {\"Content-Type\": \"application/json\"}\n    headers['X-Auth-Token']=requests.post(auth_url, headers=headers, data=json.dumps(auth_data)).headers['X-Subject-Token']\n    return headers\n\nheaders = auth()\n\n# \u5c1d\u8bd5\u5220\u9664\u5df2\u5b58\u5728\u7684flavor\nres = requests.get(url='http://192.168.100.10:8774/v2.1/flavors', headers=headers)\nflavors = res.json()['flavors']\nname = 'test1'\nfor flavor in flavors:\n    if flavor['name'] == name:\n        delete_url = f\"http://192.168.100.10:8774/v2.1/flavors/{flavor['id']}\"\n        response = requests.delete(delete_url, headers=headers)\n        print('\u540c\u540d\u5b9e\u4f8b\u5220\u9664\u6210\u529f')\n        break\n\n        # \u521b\u5efa\u65b0\u7684flavor\nflavor_data = {\"flavor\": {\"vcpus\": 2,\"disk\": 20,\"name\": \"test1\",\"os-flavor-access:is_public\": True,\"rxtx_factor\": 1.0,\"OS-FLV-EXT-DATA:ephemeral\": 0,\"ram\": 1024,\"swap\": 0}}\nres = requests.post(url='http://192.168.100.10:8774/v2.1/flavors', headers=headers, data=json.dumps(flavor_data))\n\nif res.status_code == 201:\n    new_flavor_id = res.json()['flavor']['id']\n    print(f'\u5b9e\u4f8b\u521b\u5efa\u6210\u529f,\u65b0flavor ID: {new_flavor_id}')\nelse:\n    print(f'\u5b9e\u4f8b\u521b\u5efa\u5931\u8d25,\u5931\u8d25\u72b6\u6001\u7801\u4e3a{res.status_code}')\n</code></pre>"}, {"location": "openstack%20api/create_image/", "title": "image", "text": "<p>image</p> <pre><code>#\u83b7\u53d6token \u65b9\u6cd5 /usr/lib/python2.7/site-packages/glance/common/auth.py 199\u884c\n\nimport json\nimport requests\n\n\ndef auth():\n    auth_url = 'http://11.0.1.100:5000/v3/auth/tokens'\n    auth_body = {\n        \"auth\": {\n            \"identity\": {\n                \"methods\": [\"password\"],\n                \"password\": {\n                    \"user\": {\n                        \"name\": 'admin',\n                        \"domain\": {\"name\": \"demo\"},\n                        \"password\": '000000'\n                    }\n                }\n            },\n            \"scope\": {\n                \"project\": {\n                    \"name\": 'admin',\n                    \"domain\": {\n                        \"name\": \"demo\"\n                    }\n                }\n            }\n        }\n    }\n\n    headers = {'Content-Type': 'application/json'}\n    headers['X-Auth-Token'] = requests.post(auth_url, headers=headers, data=json.dumps(auth_body)).headers['X-Subject-Token']\n    return headers\n\n\nheaders = auth()\nimage_url = 'http://11.0.1.100:9292/v2/images'\nname = 'cirros2'\n\n# \u5220\u9664\u540c\u540d\u955c\u50cf\nres = requests.get(image_url, headers=headers)\nimages = res.json()['images']\nfor image in images:\n    if image['name'] == name:\n        delete_url = f\"{image_url}/{image['id']}\"\n        requests.delete(delete_url, headers=headers)\n        print(\"\u76f8\u540c\u955c\u50cf\u5df2\u7ecf\u5220\u9664\")\n        break\n\n# \u521b\u5efa\u65b0\u955c\u50cf\nimage_body = {\"min_disk\": 20, \"container_format\": \"bare\", \"min_ram\": 1024, \"disk_format\": \"qcow2\", \"name\": name}\nres = requests.post(image_url, data=json.dumps(image_body), headers=headers)\nprint(json.dumps(res.json(),indent=4))\n\nif res.status_code == 201:\n    image_id = res.json()['id']\n    image_put_url = f\"{image_url}/{image_id}/file\"\n    headers[\"Content-Type\"] = \"application/octet-stream\"\n    res=requests.put(image_put_url, data=open('/root/cirros-0.3.4-x86_64-disk.img', 'rb').read(), headers=headers)\n    if res.status_code == 204:\n        print(f\"\u955c\u50cf\u521b\u5efa\u6210\u529f\\n\u955c\u50cfID\u4e3a:{image_id}\")\n        image_info= requests.get(f'{image_url}/{image_id}',headers=headers).json()\n        print(json.dumps(image_info,indent=4))\n        with open(f\"{name}.json\",'w') as f:\n            json.dump(image_info, f, indent=4)\n    else:\n        print(f\"\u4e0a\u4f20\u955c\u50cf\u6587\u4ef6\u5931\u8d25, \u72b6\u6001\u7801\u4e3a{res.status_code}\")\n</code></pre>"}, {"location": "openstack%20api/create_network/", "title": "network", "text": "<p>\u521b\u5efa \u7f51\u7edc\u548c\u5b50\u7f51</p> <pre><code>import json\nimport requests\n\ndef auth():\n    auth_url = \"http://192.168.100.10:5000/v3/auth/tokens\"\n    auth_data = {\n        \"auth\": {\n            \"identity\": {\n                \"methods\":[\"password\"],\n                \"password\":{\n                    \"user\": {\n                        \"name\":\"admin\",\n                        \"domain\": {\"name\": \"demo\"},\n                        \"password\":'000000'\n                    }\n                }\n            },\n            \"scope\": {\n                \"project\":{\n                    \"name\":\"admin\",\n                    \"domain\":{\n                        \"name\":\"demo\"\n                    }\n                }\n            }\n        }\n    }\n    headers = {\"Content-Type\": \"application/json\"}\n    headers['X-Auth-Token'] = requests.post(auth_url,headers=headers,data=json.dumps(auth_data)).headers['X-Subject-Token']\n    return headers\n\nheaders=auth()\ndef network():\n    data = {\"network\": {\"router:external\": True, \"provider:network_type\": \"flat\", \"name\": 'net-1', \"provider:physical_network\": \"provider\", \"admin_state_up\": True}}\n    response = requests.post(url='http://192.168.100.10:9696/v2.0/networks',headers=headers,data=json.dumps(data))\n    print(f'net-1\u521b\u5efa\u6210\u529f')\n    return response.json()\n\n\nnetwork_id = network()['network']['id']\ndef subnet():\n    data = ({\"subnet\": {\"name\": \"subnet-1\", \"enable_dhcp\": False, \"network_id\": network_id, \"allocation_pools\": [{\"start\": \"192.168.200.10\", \"end\": \"192.168.200.100\"}],\n                        \"gateway_ip\": \"192.168.200.2\", \"ip_version\": 4, \"cidr\": \"192.168.200.0/24\"}})\n    requests.post(url='http://192.168.100.10:9696/v2.0/subnets',headers=headers,data=json.dumps(data))\n    print('subnet-1\u521b\u5efa\u6210\u529f')\n\nsubnet()\n</code></pre>"}, {"location": "openstack%20api/create_user/", "title": "user", "text": "<p>\u521b\u5efa\u7528\u6237</p> <pre><code>import json\nimport requests\n\ndef auth():\n    auth_url='http://11.0.1.100:5000/v3/auth/tokens'\n    auth_body = {\n        \"auth\": {\n            \"identity\": {\n                \"methods\": [\"password\"],\n                \"password\": {\n                    \"user\": {\n                        \"name\": 'admin',\n                        \"domain\": {'name': 'demo'},\n                        \"password\": '000000'\n                    }\n                }\n            },\n            \"scope\": {\n                \"project\": {\n                    \"name\": 'admin',\n                    \"domain\": {\n                        \"name\": 'demo'\n                    }\n                }\n            }\n        }\n    }\n\n    headers = {'Content-Type': 'application/json'}\n    headers['X-Auth-Token']=requests.post(auth_url,headers=headers,data=json.dumps(auth_body)).headers['X-Subject-Token']\n    return headers\n\nheaders=auth()\nuser_url= 'http://11.0.1.100:5000/v3/users'\ndata={'user':{'name':'test12','password':'12345678','domain':'demo'}}\nresponse=requests.post(url=user_url,headers=headers,data=json.dumps(data))\nif response.status_code == 201:\n    print('\u7528\u6237\u521b\u5efa\u6210\u529f')\n    new_user_id = response.json()['user']['id']\n    print(f'\u65b0\u7528\u6237ID\uff1a{new_user_id}')\nelse:\n    print('\u7528\u6237\u521b\u5efa\u5931\u8d25')\n</code></pre>"}, {"location": "selenium/selenium%E5%8E%86%E5%8F%B2%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/", "title": "selenium\u5386\u53f2\u5b66\u4e60\u8bb0\u5f55", "text": "<p>seleium \u5b66\u4e60\u8bb0\u5f55</p> <pre><code> #\u4e00\u5957\u9898\u76ee\u6d41\u7a0b\n\n#\u7b2c\u4e00\u9898\nfrom selenium.webdriver.common.by import By\nfrom selenium import webdriver\n\ndriver = webdriver.Chrome()\ndriver.get('http://hmshop-test.itheima.net/Home/user/login.html')\ndriver.implicitly_wait(3)\ndriver.find_element(By.CLASS_NAME,'text_cmu').send_keys('13012345678')\ndriver.find_element(By.ID,'password').send_keys('123456')\ndriver.find_element(By.ID,'verify_code').send_keys('8888')\ndriver.find_elements(By.TAG_NAME,'a')[3].click()\ndriver.find_element(By.LINK_TEXT,'\u6d88\u606f\u901a\u77e5').click()\ndriver.find_elements(By.NAME,'msg_id')[0].click()\ndriver.get_screenshot_as_file(r'D:\\test_accept01.png')\n\n\n#\u7b2c\u4e8c\u9898\nimport unittest\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\n\nclass denglu(unittest.TestCase):\n    def setUp(self):\n        self.driver = webdriver.Chrome()\n        self.driver.get('http://hmshop-test.itheima.net/Home/user/login.html')\n        self.driver.implicitly_wait(3)\n        self.driver.maximize_window()\n    def tearDown(self):\n        self.driver.quit()\n    def test_denglu01(self):\n        driver = self.driver\n        driver.implicitly_wait(3)\n        driver.find_element(By.CLASS_NAME, 'text_cmu').send_keys('13012345678')\n        driver.find_element(By.NAME, 'password').send_keys('123456')\n        driver.find_element(By.ID, 'verify_code').send_keys('8888')\n        driver.find_element(By.XPATH, '//*[@id=\"loginform\"]/div/div[6]/a').click()\n    def test_denglu02(self):\n        driver=self.driver\n        driver.implicitly_wait(3)\n        driver.find_element(By.NAME,'username').send_keys('13012345678')\n        driver.find_element(By.ID, 'password').send_keys('123456')\n        driver.find_element(By.ID, 'verify_code').send_keys('8888')\n        driver.find_elements(By.TAG_NAME, 'a')[3].click()\n        driver.find_element(By.XPATH,'/html/body/div[1]/div/div/ul/li[1]/a').click()\n        driver.get_screenshot_as_file(r'D:\\test_accept02.png')\n\nif __name__ == '__main__':\n    unittest.main()\n\n\n#\u7b2c\u4e09\u9898  \u9700\u8981\u5176\u4ed6\u6570\u636ecsvv.csv\n\n# csv\nimport csv\ndef read():\n    path = (r'C:\\Users\\Z\\Desktop\\11\\testdata.csv')\n    steam=open(path,'r',encoding='UTF-8')\n    data=csv.reader(steam)\n    list=[]\n    i=0\n    for row in data:\n        if i!=0:\n            list.append(row)\n        i=i+1\n    return list\n\nif __name__ == '__main__':\n    data=read()\n    for row in data:\n        print(row)\n\n\n\nimport ddt\nimport unittest\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom csvv import read\nimport time\n\n@ddt.ddt\nclass denglu(unittest.TestCase):\n    def setUp(self):\n        self.driver = webdriver.Chrome()\n        self.driver.get('http://hmshop-test.itheima.net/Home/user/login.html')\n        time.sleep(5)\n        self.driver.maximize_window()\n    def tearDown(self):\n        self.driver.quit()\n    steam = read()\n    @ddt.data(*steam)\n    def test_denglu01(self,list):\n        try:\n            self.driver.implicitly_wait(3)\n            self.driver.find_element(By.ID,'username').send_keys(list[0])\n            self.driver.find_element(By.NAME,'password').send_keys(list[1])\n            self.driver.find_element(By.ID,'verify_code').send_keys('8888')\n            self.driver.find_element(By.CSS_SELECTOR,'.J-login-submit').click()\n            self.driver.implicitly_wait(10)\n            a = self.driver.find_element(By.CSS_SELECTOR,\".layui-layer-content\").text\n            print(a)\n            self.assertEqual(a,list[2])\n            time.sleep(1)\n        except Exception as z:\n            print('\u5f02\u5e38\u62a5\u9519' '\\n')\n            self.driver.get_screenshot_as_file(r'C:\\Users\\Z\\Desktop\\11\\baocuo1.png')\n        finally:\n            print('\u8fd9\u6b21\u7a0b\u5e8f\u8fd0\u884c\u7ed3\u675f' + '\\n')\n\nif __name__ == '__main__':\n    unittest.main()\n</code></pre> <p>7.21 \u7ec3\u4e60</p> <pre><code>import time\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.select import Select\nfrom selenium.webdriver.common.action_chains import ActionChains\n\ndriver =webdriver.Chrome()\n#\u63d0\u793a\u6846\n# driver.get(r'C:\\Users\\Z\\Desktop\\11\\alert.html')\n# driver.implicitly_wait(3)\n# driver.maximize_window()\n# driver.find_element(By.ID,'alerta').click() #\u63d0\u793a\u6846\n# driver.switch_to.alert.accept()\n# time.sleep(2)\n# driver.find_element(By.XPATH,'//*[@id=\"confirma\"]').click() #\u786e\u8ba4\u6846\n# driver.switch_to.alert.dismiss()\n# time.sleep(2)\n# driver.find_element(By.XPATH,'//*[@id=\"prompta\"]').click() #\u8f93\u5165\u6846\n# time.sleep(1)\n# driver.switch_to.alert.accept()\n# time.sleep(2)\n# a = driver.find_element(By.XPATH,'//*[@id=\"confirma\"]') #\u4e0d\u80fd\u6253\u5370\u6587\u5b57\n# print(a.text)\n\n#\u4e0b\u62c9\u6846\n# driver.get(r'C:\\Users\\Z\\Desktop\\11\\register.html')\n# name = driver.find_element(By.NAME,'selecta')\n# Select(name).select_by_index(3)\n# time.sleep(2)\n# Select(name).select_by_value('gz')\n# time.sleep(1)\n# Select(name).select_by_visible_text('\u5317\u4eac')\n# time.sleep(1)\n\n# driver.get('http://www.jd.com')\n# driver.maximize_window()\n# a = driver.find_element(By.LINK_TEXT,'\u5bb6\u7528\u7535\u5668')\n# ActionChains(driver).move_to_element(a).perform()\n# a.click()\n# time.sleep(2)\n# driver.find_element(By.XPATH,'//*[@id=\"ttbar-login\"]/a[1]').click()  #\u5bb6\u7528\u7535\u5668\u9875\u9762\u8df3\u8f6c\u767b\u5f55\u754c\u9762\u6ca1\u53cd\u5e94\u4f46\u662f\u6ca1\u62a5\u9519\n# time.sleep(2)\n\n\n# driver.get('http://www.jd.com')\n# driver.maximize_window()\n# driver.maximize_window()\n# handle1 = driver.current_window_handle\n# print('\u8f93\u5165\u5f53\u524d\u53e5\u67c4\u53f7\uff1a',handle1)\n#\n# driver.find_element(By.LINK_TEXT,'\u5bb6\u7528\u7535\u5668').click()\n# handle2 = driver.current_window_handle\n# print('\u8f93\u5165\u6240\u6709\u53e5\u67c4\u53f7:',handle2)\n# time.sleep(2)\n# driver.switch_to.window(driver.window_handles[0])\n# time.sleep(3)\n\n\n# driver.get('http://hmshop-test.itheima.net/Home/user/login.html')\n# driver.maximize_window()\n# driver.find_element(By.XPATH,'//*[@id=\"username\"]').send_keys('13800000002')\n# driver.find_element(By.XPATH,'//*[@id=\"password\"]').send_keys('123456')\n# driver.find_element(By.XPATH,'//*[@id=\"verify_code\"]').send_keys('8888')\n# driver.find_element(By.NAME,'sbtbutton').click()\n# driver.implicitly_wait(5) #\u667a\u80fd\u7b49\u5f85\n# a = driver.find_element(By.XPATH,'/html/body/div[2]/div/div[3]/ul/li[2]/div/div[1]/span')\n# ActionChains(driver).move_to_element(a).perform()\n# driver.find_element(By.XPATH,'/html/body/div[2]/div/div[3]/ul/li[2]/div/div[2]/a[2]').click()\n# driver.find_element(By.XPATH,'/html/body/div[3]/div/div[2]/div[2]/div/div[1]/a/span').click()\n# driver.find_element(By.XPATH,'//*[@id=\"address_form\"]/div[2]/div/div[2]/div[1]/div/input').send_keys('\u5c0f\u4e2d')\n# driver.find_element(By.XPATH,'//*[@id=\"address_form\"]/div[2]/div/div[2]/div[2]/div/input').send_keys('13800000088')\n# a= driver.find_element(By.ID,'province')\n# Select(a).select_by_visible_text('\u5317\u4eac')\n# b = driver.find_element(By.XPATH,'//*[@id=\"city\"]')\n# Select(b).select_by_value('72')\n# c = driver.find_element(By.NAME,'district')\n# Select(c).select_by_index(41)\n# driver.find_element(By.XPATH,'//*[@id=\"address_form\"]/div[2]/div/div[2]/div[4]/div/input').send_keys('\u5317\u4eac\u671d\u9633\u533a')\n# driver.find_element(By.XPATH,'//*[@id=\"address_submit\"]').click()\n# time.sleep(2) #\u5f3a\u5236\u7b49\u5f85\n# #\u6dfb\u52a0\u6210\u529f\n</code></pre>"}, {"location": "%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91/video/", "title": "video", "text": "<p>python selenium \u5e93 \u5b9e\u73b0\u81ea\u52a8\u5316</p>"}, {"location": "%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91/video/#_1", "title": "\u81ea\u52a8\u5316\u89c6\u9891", "text": "<p>\u4ee5\u4e0b\u662f\u81ea\u52a8\u5316\u89c6\u9891\u7684\u6f14\u793a\uff1a</p>"}, {"location": "%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91/video/#http", "title": "http \u670d\u52a1\u642d\u5efa", "text": ""}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/", "title": "Kubernetes\u5f03\u7528Docker", "text": ""}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/#1kubernetes", "title": "1.Kubernetes\u7b80\u4ecb", "text": "<p>Kubernetes \u6e90\u81ea\u5e0c\u814a\u8bed\uff0c\u610f\u4e3a\u201c\u8235\u624b\u201d\u6216\u201c\u98de\u884c\u5458\u201d\u3002Kubernetes \u662f Google \u516c\u53f8\u4e8e2014\u5e746\u6708\u53d1\u5e03\u7684\u5f00\u6e90\u5bb9\u5668\u7f16\u6392\u5f15\u64ce\uff0c\u524d\u8eab\u662f Google \u7684\u5185\u90e8 Borg (Borg \u662f\u6700\u65e9\u7684\u5bb9\u5668\u7f16\u6392\u7cfb\u7edf\uff0c\u5728 Google \u5185\u90e8\u8fd0\u884c\u8d85\u8fc7 15 \u5e74)\u3002 \u901a\u5e38\uff0c\u4e1a\u5185\u66f4\u4e60\u60ef\u7684\u7b80\u79f0 Kubernetes \u4e3a \"K8s\"\u3002\u5b98\u65b9\u7f51\u7ad9</p> <p></p>"}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/#2kubernetesdocker", "title": "2.Kubernetes\u5bf9\u6bd4Docker", "text": ""}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/#21", "title": "2.1 \u5c42\u6b21\u5dee\u5f02", "text": "<p>\u6309\u5206\u5c42\u7684\u67b6\u6784\u601d\u60f3\u6765\u8bc4\u4ef7\u4e8c\u8005\uff0cDocker \u66f4\u50cf\u662f\u5e95\u5c42\uff1b\u800c K8s \u5219\u66f4\u50cf\u4e0a\u5c42\u3002</p>"}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/#22", "title": "2.2 \u5e94\u7528\u9886\u57df", "text": "<p>2013\u5e74\u521d Docker Inc \u516c\u53f8\u6210\u7acb\uff0c\u540c\u5e743\u6708\u5c06 Docker \u5f00\u6e90(\u524d\u8eab\u662f DotCloud \u516c\u53f8\u7684\u5185\u90e8\u9879\u76ee)\uff1b</p> <p>\u4e00\u4e2a\u5e94\u7528\u901a\u5e38\u662f\u7531\u591a\u4e2a\u5bb9\u5668(\u670d\u52a1)\u7ec4\u6210\u7684\uff0cDocker \u672c\u8d28\u4e0a\u662f\u5c06\u7a0b\u5e8f\u548c\u7a0b\u5e8f\u8fd0\u884c\u73af\u5883\u6253\u5305\u6210\u955c\u50cf\uff0c\u5e76\u7531\u6b64\u8fd0\u884c\u5bb9\u5668\u7684\u5f15\u64ce\u3002</p> <p> </p>"}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/#23", "title": "2.3 \u4e8c\u8005\u7684\u7ade\u4e89", "text": "<p>\u7ade\u4e89\uff1a\u770b\u56fe\u8bf4\u8bdd</p>"}, {"location": "%E8%80%81%E6%9D%8Ek8s%E7%AC%94%E8%AE%B0/k8s%E5%AD%A6%E4%B9%A0/01.%E5%BC%80%E7%AF%87/%E7%AC%94%E8%AE%B0/Kubernetes%20-%2001/#3", "title": "3.\u7ed3\u675f\u8bed", "text": "<p>\"K8s \u5f03\u7528 Docker\"\u8fd9\u4e2a\u4ee4\u4e1a\u5185\u5f15\u8d77\u9a9a\u52a8\u7684\u8bdd\u8bed\uff0c\u662f\u4e00\u79cd\u8bef\u89e3\uff1b</p> <p>\u771f\u5b9e\u7684\u60c5\u51b5\u662f\uff1aK8s \u81ea1.24\u7248\u5220\u9664\u4e86\"docker-shim\"\uff0c\u4e0d\u518d\u76f4\u63a5\u4f7f\u7528 docker \u4f5c\u4e3a\u5e95\u5c42\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u3002</p>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/", "title": "Kubernetes\u4ecb\u7ecd", "text": "<p>kubernetes\uff08k8s\uff09\u662f2014\u5e74\u7531Google\u516c\u53f8\u57fa\u4e8eGo\u8bed\u8a00\u7f16\u5199\u7684\u4e00\u6b3e\u5f00\u6e90\u7684\u5bb9\u5668\u96c6\u7fa4\u7f16\u6392\u7cfb\u7edf\uff0c\u7528\u4e8e\u81ea\u52a8\u5316\u5bb9\u5668\u7684\u90e8\u7f72\u3001\u6269\u7f29\u5bb9\u548c\u7ba1\u7406\uff1b</p> <p>kubernetes\uff08k8s\uff09\u662f\u57fa\u4e8eGoogle\u5185\u90e8\u7684Borg\u7cfb\u7edf\u7684\u7279\u5f81\u5f00\u53d1\u7684\u4e00\u4e2a\u7248\u672c\uff0c\u96c6\u6210\u4e86Borg\u7cfb\u7edf\u5927\u90e8\u5206\u4f18\u52bf\uff1b</p> <p>\u5b98\u65b9\u5730\u5740\uff1ahttps://Kubernetes.io</p> <p>\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0\uff1ahttps://github.com/Kubernetes</p> <p></p>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/#kubernetes_1", "title": "kubernetes\u5177\u5907\u7684\u529f\u80fd", "text": "<ul> <li>\u81ea\u6211\u4fee\u590d\uff1ak8s\u53ef\u4ee5\u76d1\u63a7\u5bb9\u5668\u7684\u8fd0\u884c\u72b6\u51b5\uff0c\u5e76\u5728\u53d1\u73b0\u5bb9\u5668\u51fa\u73b0\u5f02\u5e38\u65f6\u81ea\u52a8\u91cd\u542f\u6545\u969c\u5b9e\u4f8b\uff1b</li> <li>\u5f39\u6027\u4f38\u7f29\uff1ak8s\u53ef\u4ee5\u6839\u636e\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u81ea\u52a8\u5730\u8c03\u6574\u5bb9\u5668\u7684\u526f\u672c\u6570\u3002\u4f8b\u5982\uff0c\u5728\u9ad8\u5cf0\u65f6\u6bb5\uff0ck8s\u53ef\u4ee5\u81ea\u52a8\u589e\u52a0\u5bb9\u5668\u7684\u526f\u672c\u6570\u4ee5\u5e94\u5bf9\u66f4\u591a\u7684\u6d41\u91cf\uff1b\u800c\u5728\u4f4e\u5cf0\u65f6\u6bb5\uff0ck8s\u53ef\u4ee5\u51cf\u5c11\u5e94\u7528\u7684\u526f\u672c\u6570\uff0c\u8282\u7701\u8d44\u6e90\uff1b</li> <li>\u8d44\u6e90\u9650\u989d\uff1ak8s\u5141\u8bb8\u6307\u5b9a\u6bcf\u4e2a\u5bb9\u5668\u6240\u9700\u7684CPU\u548c\u5185\u5b58\u8d44\u6e90\uff0c\u80fd\u591f\u66f4\u597d\u7684\u7ba1\u7406\u5bb9\u5668\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\uff1b</li> <li>\u6eda\u52a8\u5347\u7ea7\uff1ak8s\u53ef\u4ee5\u5728\u4e0d\u4e2d\u65ad\u670d\u52a1\u7684\u60c5\u51b5\u4e0b\u6eda\u52a8\u5347\u7ea7\u5e94\u7528\u7248\u672c\uff0c\u786e\u4fdd\u5728\u6574\u4e2a\u8fc7\u7a0b\u4e2d\u4ecd\u6709\u8db3\u591f\u7684\u5b9e\u4f8b\u5728\u63d0\u4f9b\u670d\u52a1\uff1b</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1ak8s\u53ef\u4ee5\u6839\u636e\u5e94\u7528\u7684\u8d1f\u8f7d\u60c5\u51b5\u81ea\u52a8\u5206\u914d\u6d41\u91cf\uff0c\u786e\u4fdd\u5404\u4e2a\u5b9e\u4f8b\u4e4b\u95f4\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u907f\u514d\u67d0\u4e9b\u5b9e\u4f8b\u8fc7\u8f7d\u5bfc\u81f4\u7684\u6027\u80fd\u4e0b\u964d\uff1b</li> <li>\u670d\u52a1\u53d1\u73b0\uff1ak8s\u53ef\u4ee5\u81ea\u52a8\u53d1\u73b0\u5e94\u7528\u7684\u5b9e\u4f8b\uff0c\u5e76\u4e3a\u5b83\u4eec\u5206\u914d\u4e00\u4e2a\u7edf\u4e00\u7684\u8bbf\u95ee\u5730\u5740\u3002\u8fd9\u6837\uff0c\u7528\u6237\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u7edf\u4e00\u7684\u5730\u5740\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5230\u5e94\u7528\u7684\u4efb\u610f\u5b9e\u4f8b\uff0c\u800c\u65e0\u9700\u5173\u5fc3\u5177\u4f53\u7684\u5b9e\u4f8b\u4fe1\u606f\uff1b</li> <li>\u5b58\u50a8\u7ba1\u7406\uff1ak8s\u53ef\u4ee5\u81ea\u52a8\u7ba1\u7406\u5e94\u7528\u7684\u5b58\u50a8\u8d44\u6e90\uff0c\u4e3a\u5e94\u7528\u63d0\u4f9b\u6301\u4e45\u5316\u7684\u6570\u636e\u5b58\u50a8\u3002\u8fd9\u6837\uff0c\u5728\u5e94\u7528\u5b9e\u4f8b\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u7528\u6237\u6570\u636e\u4ecd\u80fd\u4fdd\u6301\u4e00\u81f4\uff0c\u786e\u4fdd\u6570\u636e\u7684\u6301\u4e45\u6027\uff1b</li> <li>\u5bc6\u94a5\u4e0e\u914d\u7f6e\u7ba1\u7406\uff1aKubernetes \u5141\u8bb8\u4f60\u5b58\u50a8\u548c\u7ba1\u7406\u654f\u611f\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a\u5bc6\u7801\u3001\u4ee4\u724c\u3001\u8bc1\u4e66\u3001ssh\u5bc6\u94a5\u7b49\u4fe1\u606f\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\uff0c\u5e76\u5171\u4eab\u7ed9\u591a\u4e2a\u5bb9\u5668\u590d\u7528\uff1b</li> </ul>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/#kubernetes_2", "title": "kubernetes\u96c6\u7fa4\u89d2\u8272", "text": "<p>k8s\u96c6\u7fa4\u9700\u8981\u5efa\u2f74\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\uff0c\u5c06\u591a\u4e2a\u8282\u70b9\u7ec4\u5efa\u6210\u4e00\u4e2a\u96c6\u7fa4\uff0c\u7136\u540e\u8fdb\u2f8f\u7edf\u2f00\u7ba1\u7406\uff0c\u4f46\u662f\u5728k8s\u96c6\u7fa4\u5185\u90e8\uff0c\u8fd9\u4e9b\u8282\u70b9\u2f1c\u88ab\u5212\u5206\u6210\u4e86\u4e24\u7c7b\u2ec6\u2f8a\uff1a</p> <ul> <li>\u4e00\u7c7b\u2ec6\u2f8a\u4e3a\u7ba1\u7406\u8282\u70b9\uff0c\u53ebMaster\uff0c\u8d1f\u8d23\u96c6\u7fa4\u7684\u6240\u6709\u7ba1\u7406\u5de5\u4f5c\uff1b</li> <li>\u2f00\u7c7b\u2ec6\u2f8a\u4e3a\u2f2f\u4f5c\u8282\u70b9\uff0c\u53ebNode\uff0c\u8d1f\u8d23\u8fd0\u884c\u96c6\u7fa4\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bb9\u5668\u5e94\u7528 \uff1b </li> </ul>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/#master", "title": "Master\u7ba1\u7406\u8282\u70b9\u7ec4\u4ef6", "text": "<ul> <li> <p>API Server\uff1a\u4f5c\u4e3a\u96c6\u7fa4\u7684\u7ba1\u7406\u5165\u53e3\uff0c\u5904\u7406\u5916\u90e8\u548c\u5185\u90e8\u901a\u4fe1\uff0c\u63a5\u6536\u7528\u6237\u8bf7\u6c42\u5e76\u5904\u7406\u96c6\u7fa4\u5185\u90e8\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u4fe1\uff1b</p> </li> <li> <p>Scheduler\uff1a\u4f5c\u4e3a\u96c6\u7fa4\u8d44\u6e90\u8c03\u5ea6\u8ba1\u7b97\uff0c\u6839\u636e\u8c03\u5ea6\u7b56\u7565\uff0c\u8d1f\u8d23\u5c06\u5f85\u90e8\u7f72\u7684 Pods \u5206\u914d\u5230\u5408\u9002\u7684 Node \u8282\u70b9\u4e0a\uff1b</p> </li> <li> <p>Controller Manager\uff1a\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u5404\u79cd\u63a7\u5236\u5668\uff0c\u4f8b\u5982 Deployment\u3001ReplicaSet\u3001DaemonSet\u7b49\uff0c\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u5404\u79cd\u8d44\u6e90\uff1b</p> </li> <li> <p>etcd\uff1a\u4f5c\u4e3a\u96c6\u7fa4\u7684\u6570\u636e\u5b58\u50a8\uff0c\u4fdd\u5b58\u96c6\u7fa4\u7684\u914d\u7f6e\u4fe1\u606f\u548c\u72b6\u6001\u4fe1\u606f\uff1b</p> </li> </ul>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/#node", "title": "Node\u5de5\u4f5c\u8282\u70b9\u7ec4\u4ef6", "text": "<ul> <li> <p>Kubelet\uff1a\u8d1f\u8d23\u4e0e Master \u8282\u70b9\u901a\u4fe1\uff0c\u5e76\u6839\u636e Master \u8282\u70b9\u7684\u8c03\u5ea6\u51b3\u7b56\u6765\u521b\u5efa\u3001\u66f4\u65b0\u548c\u5220\u9664 Pod\uff0c\u540c\u65f6\u7ef4\u62a4 Node \u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u72b6\u6001\uff1b</p> </li> <li> <p>\u5bb9\u5668\u8fd0\u884c\u65f6\uff08\u5982 Docker\u3001containerd \u7b49\uff09\uff1a\u8d1f\u8d23\u8fd0\u884c\u548c\u7ba1\u7406\u5bb9\u5668\uff0c\u63d0\u4f9b\u5bb9\u5668\u751f\u547d\u5468\u671f\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\uff1a\u521b\u5efa\u3001\u66f4\u65b0\u3001\u5220\u9664\u5bb9\u5668\u7b49\uff1b</p> </li> <li> <p>Kube-proxy\uff1a\u8d1f\u8d23\u4e3a\u96c6\u7fa4\u5185\u7684\u670d\u52a1\u5b9e\u73b0\u7f51\u7edc\u4ee3\u7406\u548c\u8d1f\u8f7d\u5747\u8861\uff0c\u786e\u4fdd\u670d\u52a1\u7684\u8bbf\u95ee\u6027\uff1b</p> </li> </ul> <p></p>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/#_1", "title": "\u975e\u5fc5\u987b\u7684\u96c6\u7fa4\u63d2\u4ef6", "text": "<ul> <li> <p>DNS\u670d\u52a1\uff1a\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u5fc5\u987b\u63d2\u4ef6\uff0c\u5728k8s\u4e2d\uff0c\u5f88\u591a\u529f\u80fd\u90fd\u9700\u8981\u7528\u5230DNS\u670d\u52a1\uff0c\u4f8b\u5982\uff1a\u670d\u52a1\u53d1\u73b0\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u6709\u72b6\u6001\u5e94\u7528\u7684\u8bbf\u95ee\u7b49\uff1b</p> </li> <li> <p>Dashboard\uff1a \u662fk8s\u96c6\u7fa4\u7684Web\u7ba1\u7406\u754c\u9762\uff1b</p> </li> <li> <p>\u8d44\u6e90\u76d1\u63a7\uff1a\u4f8b\u5982metrics-server\u76d1\u89c6\u5668\uff0c\u7528\u4e8e\u76d1\u63a7\u96c6\u7fa4\u4e2d\u8d44\u6e90\u5229\u7528\u7387\uff1b</p> </li> </ul>"}, {"location": "%E8%B5%84%E6%96%99/K8s%E4%BB%8B%E7%BB%8D/#kubernetes_3", "title": "kubernetes\u96c6\u7fa4\u7c7b\u578b", "text": "<ul> <li> <p>\u4e00\u4e3b\u591a\u4ece\u96c6\u7fa4\uff1a\u7531\u4e00\u53f0Master\u7ba1\u7406\u8282\u70b9\u548c\u591a\u53f0Node\u5de5\u4f5c\u8282\u70b9\u7ec4\u6210\uff0c\u751f\u4ea7\u73af\u5883\u4e0bMaster\u8282\u70b9\u5b58\u5728\u5355\u70b9\u6545\u969c\u7684\u98ce\u9669\uff0c\u9002\u5408\u5b66\u4e60\u548c\u6d4b\u8bd5\u73af\u5883\u4f7f\u7528\uff1b </p> </li> <li> <p>\u591a\u4e3b\u591a\u4ece\u96c6\u7fa4\uff1a\u7531\u591a\u53f0Master\u7ba1\u7406\u8282\u70b9\u548c\u591aNode\u5de5\u4f5c\u8282\u70b9\u7ec4\u6210\uff0c\u5b89\u5168\u6027\u9ad8\uff0c\u9002\u5408\u751f\u4ea7\u73af\u5883\u4f7f\u7528\uff1b </p> </li> </ul>"}, {"location": "%E8%B5%84%E6%96%99/ai/", "title": "ai\u90e8\u7f72", "text": "<p>Linux\u90e8\u7f72DeepSeek r1 \u6a21\u578b\u8bad\u7ec3</p>"}, {"location": "%E8%B5%84%E6%96%99/ansible/", "title": "ansible\u4ecb\u7ecd", "text": "<p>ansible\u662f\u4e00\u6b3e\u5f00\u6e90\u81ea\u52a8\u5316\u5e73\u53f0\u3002\u4e00\u79cd\u7b80\u5355\u7684\u81ea\u52a8\u5316\u8bed\u8a00\u6216\u5de5\u5177</p> <ul> <li>\u7b80\u5355\u660e\u4e86</li> <li>\u529f\u80fd\u5f3a\u5927</li> <li>\u65e0\u9700\u4ee3\u7406</li> </ul> <p>\u7ba1\u7406\u8282\u70b9\u901a\u8fc7ssh\u7ba1\u7406\u53d7\u7ba1\u4e3b\u673a</p>"}, {"location": "%E8%B5%84%E6%96%99/ansible/#ansible_1", "title": "ansible\u5de5\u4f5c\u6d41\u7a0b", "text": "<ol> <li>Host inventory\uff08\u4e3b\u673a\u6e05\u5355\u4e2d\uff09\u6307\u5b9a\u6211\u4eec\u9700\u8981\u6267\u884c\u7684\u4e3b\u673a\u8303\u56f4\uff0c\u6587\u4ef6\u4f4d\u7f6e\u4f4d\u4e8e <code>/etc/ansible/hosts</code></li> <li>Playbook\uff08\u5267\u672c\uff09\u6587\u4ef6\u4e2d\u786e\u5b9a\u8981\u5bf9\u76ee\u6807\u4e3b\u673a\u505a\u7684\u4e8b\u60c5\uff0c\u5982\u521b\u5efa\u6587\u4ef6\u3001\u590d\u5236\u6587\u4ef6\u3001\u5b89\u88c5\u670d\u52a1\u7b49\u3002</li> <li>\u8c03\u7528\u6a21\u5757\uff08Core Modules\uff09\u4e2d\u7684\u6a21\u5757\uff0c\u5982\u8981\u521b\u5efa\u6216\u5220\u9664\u6587\u4ef6\u8c03\u7528 <code>file</code> \u6a21\u5757\uff0c\u590d\u5236\u8c03\u7528 <code>copy</code> \u6a21\u5757\uff0c\u5b89\u88c5\u670d\u52a1\u5e94\u7528\u8c03\u7528 <code>yum</code> \u6a21\u5757\u7b49\u3002</li> <li>\u5c06\u524d\u4e09\u6b65\u52a0\u8f7d\u5230Ansible\u6a21\u5757\u91cc\u3002</li> <li>Ansible\u5c06\u6536\u5230\u7684\u524d\u4e09\u6b65\u7f16\u8bd1\u6210\u81ea\u5df1\u7684\u8bed\u8a00\u6253\u5305\u53d1\u9001\u7ed9\u8fde\u63a5\u63d2\u4ef6\uff08Connection Plugins\uff09</li> <li>\u8fde\u63a5\u63d2\u4ef6\uff08Connection Plugins\uff09\u53d1\u9001\u7ed9\u8fde\u63a5\u7684\u4e3b\u673a/\u88ab\u7ba1\u7406\u7aef</li> <li>\u4e3b\u673a\uff08Host\uff09\u4e3b\u673a\u6267\u884cplaybook\u4e2d\u8c03\u7528\u6a21\u5757\u4ea7\u751f\u7684\u52a8\u4f5c\uff0c\u5982\u6279\u91cf\u5b89\u88c5apache web\u670d\u52a1 <code>yum install httpd -y</code></li> </ol>"}, {"location": "%E8%B5%84%E6%96%99/ansible/#_1", "title": "\u5b66\u4e60\u73af\u5883", "text": "ansible-master 192.168.3.121 ansible-node1 192.168.3.122 ansible-node2 192.168.3.123 test \u7ec4 dev ansible-node1 ansible-node2"}, {"location": "%E8%B5%84%E6%96%99/ansible/#_2", "title": "\u5b89\u88c5", "text": "<p>\u7531\u4e8e\u6211\u7684\u7cfb\u7edf\u662frocky linux 9 \u7684\u6700\u5c0f\u5b89\u88c5\uff0c\u9700\u8981\u5b89\u88c5\u62d3\u5c55\u5305\u6765\u5b89\u88c5ansible</p> <pre><code>dnf install -y epel-release\n#\u7528\u4e8e\u5728\u57fa\u4e8eRed Hat\u7684\u7cfb\u7edf\uff08\u5982Rocky Linux\u3001AlmaLinux\u3001CentOS\u7b49\uff09\u4e0a\u5b89\u88c5EPEL\uff08Extra Packages for Enterprise Linux\uff09\u4ed3\u5e93\n\ndnf makecache\n\ndnf install -y ansible\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible/#_3", "title": "\u914d\u7f6e\u6587\u4ef6", "text": "<p>vim /etc/ansible/hosts</p> <pre><code>[test]                 #\u914d\u7f6e\u7ec4\u540d\n192.168.3.122          #\u7ec4\u4e0b\u9762\u7684ip\n[dev]\n192.168.3.123\n</code></pre> <p>ssh\u514d\u5bc6</p> <pre><code># \u9700\u8981\u63d0\u524d\u8bbe\u7f6essh\u514d\u5bc6\uff0c\u4e0d\u7136\u540e\u9762\u767b\u5f55\u9700\u8981\u5bc6\u7801\n\nssh-keygen\nssh-copy-id root@192.168.3.122\nssh-copy-id root@192.168.3.123\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible/#_4", "title": "\u67e5\u770b\u6a21\u5757\u5e2e\u52a9\u6587\u6863", "text": "<pre><code>ansible-doc \u6a21\u5757\u540d\u79f0   #\u770b\u5b8c\u8bed\u6cd5\u53ef\u4ee5\u76f4\u63a5\u67e5\u6240\u9700\u6a21\u5757\u7684\u4f8b\u5b50\nansible-doc yum\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible/#_5", "title": "\u8bed\u6cd5\u683c\u5f0f", "text": "<p>\u4e24\u79cd\u4efb\u52a1\u6267\u884c\u6a21\u5f0f</p> <ol> <li>ad-hoc:\u8be5\u6a21\u5f0f\u76f8\u5f53\u4e8e\u4f60\u5728\u547d\u4ee4\u884c\u6267\u884c\u547d\u4ee4\uff0c\u4efb\u4f55\u547d\u4ee4\u90fd\u662f\u4e00\u6b21\u6027\u7684\uff0c\u4e0b\u6b21\u6267\u884c\u8fd8\u9700\u8981\u91cd\u65b0\u6253\u4e00\u6b21</li> <li>playbook: \u8be5\u6a21\u5f0f\u76f8\u5f53\u4e8e\u4f60\u628a\u547d\u4ee4\u7ec4\u7ec7\u5230\u6587\u4ef6\u91cc\u9762\uff0c\u540e\u7eed\u53ef\u4ee5\u53cd\u590d\u6267\u884c</li> </ol> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m copy -a \"src=./hosts dest=/etc/hosts\" \nansible: \u8fd9\u662f Ansible \u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u6267\u884c\u5404\u79cd\u81ea\u52a8\u5316\u4efb\u52a1\u3002\n\nk8s: \u8fd9\u662f\u4f60\u5728 Ansible \u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u4e3b\u673a\u7ec4\u7684\u540d\u79f0\u3002Ansible \u4f1a\u6839\u636e\u8fd9\u4e2a\u7ec4\u540d\u627e\u5230\u5bf9\u5e94\u7684\u4e3b\u673a\u5217\u8868\uff0c\u5e76\u5728\u8fd9\u4e9b\u4e3b\u673a\u4e0a\u6267\u884c\u4efb\u52a1\u3002\n\n-m copy: -m \u9009\u9879\u7528\u4e8e\u6307\u5b9a\u8981\u4f7f\u7528\u7684 Ansible \u6a21\u5757\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u662f copy \u6a21\u5757\uff0c\u5b83\u7684\u529f\u80fd\u662f\u5c06\u6587\u4ef6\u4ece\u63a7\u5236\u8282\u70b9\u590d\u5236\u5230\u76ee\u6807\u8282\u70b9\u3002\n\n-a \"src=./hosts dest=/etc/hosts\" -a \u9009\u9879\u7528\u4e8e\u4f20\u9012\u6a21\u5757\u7684\u53c2\u6570\u3002\u8fd9\u91cc\u4f20\u9012\u7ed9 copy \u6a21\u5757\u7684\u53c2\u6570\u662f\uff1a\n\nsrc=./hosts: \u6307\u5b9a\u6e90\u6587\u4ef6\u7684\u8def\u5f84\u3002./hosts \u8868\u793a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 hosts \u6587\u4ef6\u3002\n\ndest=/etc/hosts: \u6307\u5b9a\u76ee\u6807\u8def\u5f84\u3002/etc/hosts \u8868\u793a\u76ee\u6807\u8282\u70b9\u4e0a\u7684 /etc/hosts \u6587\u4ef6\n\n\n# \u7ed3\u679c\u9ec4\u8272\u8868\u793a\u6210\u529f\uff0c\u7eff\u8272\u8868\u793a\u6ca1\u6709\u5bf9\u4e3b\u673a\u8fdb\u884c\u64cd\u4f5c\uff0c\u7ea2\u8272\u62a5\u9519\n</code></pre> <pre><code>$ vim playbook/apache.yml\n---            # yaml\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u8bc1\u660e\u4ed6\u662f\u4e00\u4e2ayaml\u6587\u4ef6\n- name: web    #\u6307\u5b9aplay\u7684\u540d\u79f0\n  hosts: all   # \u6307\u5b9a\u7ba1\u7406\u54ea\u4e9b\u4e3b\u673a\u6216\u7ec4\n  tasks:\n    - name: install the latest version of Apache # \u6a21\u5757\u63cf\u8ff0\n      yum:\n        name: httpd # \u6a21\u5757\u540d\u79f0\n        state: latest # \u72b6\u6001\uff0cpresent\u5b89\u88c5\uff0cabsent\u5220\u9664\uff0clatest\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c\n</code></pre> <pre><code>[root@ansible-master ~]# cat http.yaml \n---\n- name: web\n  hosts: all      #\u8ddf\u4e0a\u9762\u4e00\u6837 hosts:all ,\u8868\u793a\u5168\u90e8\u4e3b\u673a\n  tasks:\n    - name: install Apache\n      yum:\n        name: httpd\n        state: latest\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/", "title": "ansible\u90e8\u7f721.28.2\u96c6\u7fa4(Containerd)", "text": ""}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#kubernetes", "title": "kubernetes\u96c6\u7fa4\u89c4\u5212", "text": "\u4e3b\u673a\u540d IP\u5730\u5740 \u89d2\u8272 \u64cd\u4f5c\u7cfb\u7edf \u786c\u4ef6\u914d\u7f6e master01 192.168.3.121 \u7ba1\u7406\u8282\u70b9 Rocky linux 9.0 2CPU/4G\u5185\u5b58/50G node01 192.168.3.122 \u5de5\u4f5c\u8282\u70b9 Rocky linux 9.0 2CPU/4G\u5185\u5b58/50G node02 192.168.3.123 \u5de5\u4f5c\u8282\u70b9 Rocky linux 9.0 2CPU/4G\u5185\u5b58/50G"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#_1", "title": "\u96c6\u7fa4\u524d\u671f\u73af\u5883\u51c6\u5907", "text": "<p>\u6309\u7167\u96c6\u7fa4\u89c4\u5212\u4fee\u6539\u6bcf\u4e2a\u8282\u70b9\u4e3b\u673a\u540d  \u63d0\u793a\uff1a\u4ee5\u4e0b\u524d\u671f\u73af\u5883\u51c6\u5907\u9700\u8981\u5728\u6240\u6709\u8282\u70b9\u90fd\u6267\u884c</p> <pre><code>hostnamectl set-hostname xxx\n#\u5173\u95ed\u9632\u706b\u5899\u4ee5\u53caselinux\nsystemctl stop firewalld &amp;&amp; systemctl disable firewalld\nsetenforce 0\nsed -i '/^SELINUX=/c SELINUX=disabled' /etc/selinux/config\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#ansible", "title": "\u5b89\u88c5ansible", "text": "<pre><code>dnf install -y epel-release\n#\u7528\u4e8e\u5728\u57fa\u4e8eRed Hat\u7684\u7cfb\u7edf\uff08\u5982Rocky Linux\u3001AlmaLinux\u3001CentOS\u7b49\uff09\u4e0a\u5b89\u88c5EPEL\uff08Extra Packages for Enterprise Linux\uff09\u4ed3\u5e93\n\ndnf makecache\n\ndnf install -y ansible\n</code></pre> <p>\u5b89\u88c5ansible\u4e4b\u540e\u7684\u4e00\u4e9b\u51c6\u5907</p> <pre><code>vim /etc/ansible/hosts\n[root@master01 ~]# cat /etc/ansible/hosts    #\u4e4b\u524d\u7684\u6ce8\u91ca\u53ef\u4ee5\u5168\u90e8\u5220\u9664\n[k8s]\n192.168.3.121\n192.168.3.122\n192.168.3.123\n\n[root@master01 ~]# ansible k8s --list-host\n  hosts (3):\n    192.168.3.121\n    192.168.3.122\n    192.168.3.123\n\n#\u914d\u7f6e\u514d\u5bc6\u767b\u5f55\nssh-keygen\n[root@master01 ~]# for ip in 192.168.3.{121..123}\n&gt; do\n&gt; ssh-copy-id $ip\n&gt; done\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#hosts", "title": "\u914d\u7f6ehosts\u6587\u4ef6", "text": "<pre><code>[root@master01 ~]# mkdir cluster-k8s   # \u521b\u5efa\u5de5\u4f5c\u76ee\u5f55\n[root@master01 ~]# cd cluster-k8s/\n[root@master01 cluster-k8s]# cp /etc/hosts ./   #\u590d\u5236 etc\u7684hosts\u6587\u4ef6\u5230\u5f53\u524d\u76ee\u5f55\n[root@master01 cluster-k8s]# cat hosts   #\u52a0\u4e0a\u4e3b\u673a\u540d\n192.168.3.121 master01\n192.168.3.122 node1\n192.168.3.123 node2\n\n[root@master01 cluster-k8s]# ansible k8s -m copy -a \"src=./hosts dest=/etc/hosts\" \nansible: \u8fd9\u662f Ansible \u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u6267\u884c\u5404\u79cd\u81ea\u52a8\u5316\u4efb\u52a1\u3002\n\nk8s: \u8fd9\u662f\u4f60\u5728 Ansible \u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u4e3b\u673a\u7ec4\u7684\u540d\u79f0\u3002Ansible \u4f1a\u6839\u636e\u8fd9\u4e2a\u7ec4\u540d\u627e\u5230\u5bf9\u5e94\u7684\u4e3b\u673a\u5217\u8868\uff0c\u5e76\u5728\u8fd9\u4e9b\u4e3b\u673a\u4e0a\u6267\u884c\u4efb\u52a1\u3002\n\n-m copy: -m \u9009\u9879\u7528\u4e8e\u6307\u5b9a\u8981\u4f7f\u7528\u7684 Ansible \u6a21\u5757\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u662f copy \u6a21\u5757\uff0c\u5b83\u7684\u529f\u80fd\u662f\u5c06\u6587\u4ef6\u4ece\u63a7\u5236\u8282\u70b9\u590d\u5236\u5230\u76ee\u6807\u8282\u70b9\u3002\n\n-a \"src=./hosts dest=/etc/hosts\" -a \u9009\u9879\u7528\u4e8e\u4f20\u9012\u6a21\u5757\u7684\u53c2\u6570\u3002\u8fd9\u91cc\u4f20\u9012\u7ed9 copy \u6a21\u5757\u7684\u53c2\u6570\u662f\uff1a\n\nsrc=./hosts: \u6307\u5b9a\u6e90\u6587\u4ef6\u7684\u8def\u5f84\u3002./hosts \u8868\u793a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 hosts \u6587\u4ef6\u3002\n\ndest=/etc/hosts: \u6307\u5b9a\u76ee\u6807\u8def\u5f84\u3002/etc/hosts \u8868\u793a\u76ee\u6807\u8282\u70b9\u4e0a\u7684 /etc/hosts \u6587\u4ef6\n\n[root@master01 cluster-k8s]# ansible k8s -m shell -a \"cat /etc/hosts\"\n\n# \u7ed3\u679c\u9ec4\u8272\u8868\u793a\u6210\u529f\uff0c\u7eff\u8272\u8868\u793a\u6ca1\u6709\u5bf9\u4e3b\u673a\u8fdb\u884c\u64cd\u4f5c\uff0c\u7ea2\u8272\u62a5\u9519\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#bridge", "title": "\u5f00\u542fbridge\u7f51\u6865\u8fc7\u6ee4", "text": "<p>bridge(\u6865\u63a5) \u662f Linux \u7cfb\u7edf\u4e2d\u7684\u4e00\u79cd\u865a\u62df\u7f51\u7edc\u8bbe\u5907\uff0c\u5b83\u5145\u5f53\u4e00\u4e2a\u865a\u62df\u7684\u4ea4\u6362\u673a\uff0c\u4e3a\u96c6\u7fa4\u5185\u7684\u5bb9\u5668\u63d0\u4f9b\u7f51\u7edc\u901a\u4fe1\u529f\u80fd\uff0c\u5bb9\u5668\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a bridge \u4e0e\u5176\u4ed6\u5bb9\u5668\u6216\u5916\u90e8\u7f51\u7edc\u901a\u4fe1\u4e86\u3002</p> <pre><code>[root@master01 cluster-k8s]# cat k8s.conf \nnet.bridge.bridge-nf-call-ip6tables = 1   #\u5bf9\u7f51\u6865\u4e0a\u7684IPv6\u6570\u636e\u5305\u901a\u8fc7iptables\u5904\u7406\nnet.bridge.bridge-nf-call-iptables = 1    #\u5bf9\u7f51\u6865\u4e0a\u7684IPv4\u6570\u636e\u5305\u901a\u8fc7iptables\u5904\u7406\nnet.ipv4.ip_forward = 1                   #\u5f00\u542fIPv4\u8def\u7531\u8f6c\u53d1,\u6765\u5b9e\u73b0\u96c6\u7fa4\u4e2d\u7684\u5bb9\u5668\u4e0e\u5916\u90e8\u7f51\u7edc\u7684\u901a\u4fe1\n[root@master01 cluster-k8s]# ansible k8s -m copy -a 'src=k8s.conf dest=/etc/sysctl.d/'\n</code></pre> <p>\u7531\u4e8e\u5f00\u542fbridge\u529f\u80fd\uff0c\u9700\u8981\u52a0\u8f7dbr_netfilter\u6a21\u5757\u6765\u5141\u8bb8\u5728bridge\u8bbe\u5907\u4e0a\u7684\u6570\u636e\u5305\u7ecf\u8fc7iptables\u9632\u706b\u5899\u5904\u7406</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a 'modprobe br_netfilter'\n</code></pre> <p>\u751f\u6548\u6587\u4ef6</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a 'sysctl -p /etc/sysctl.d/k8s.conf'   #\u7b2c\u4e00\u6b21\u9700\u8981\u624b\u52a8\u751f\u6548\uff0c\u540e\u9762\u5c31\u4f1a\u5f00\u673a\u81ea\u542f\n</code></pre> <p>\u53d1\u73b0\u91cd\u542f\u540e\u6a21\u5757\u597d\u50cf\u6ca1\u6709\u751f\u6548\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf\nbr_netfilter\nEOF\n\nsysctl --system\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#swap", "title": "\u5173\u95edSWAP\u4ea4\u6362\u5206\u533a", "text": "<p>\u4e3a\u4e86\u4fdd\u8bc1 kubelet \u6b63\u5e38\u5de5\u4f5c\uff0ck8s\u5f3a\u5236\u8981\u6c42\u7981\u7528\uff0c\u5426\u5219\u96c6\u7fa4\u521d\u59cb\u5316\u5931\u8d25</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a 'swapoff -a'  #\u4e34\u65f6\u5173\u95ed\n[root@master01 cluster-k8s]# ansible k8s -m shell -a \"sed -ri 's/.*swap.*/#&amp;/' /etc/fstab\"  #\u6c38\u4e45\u5173\u95ed   \u8fd9\u91cc\u8fd8\u9700\u8981\u6ce8\u610f\u5f15\u53f7\uff0c\u5982\u679csehll\u91cc\u9762\u6709\u5355\u5f15\u53f7\uff0c-a\u8981\u5e26\u53cc\u5f15\u53f7\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#containerd124", "title": "\u5b89\u88c5Containerd\u8f6f\u4ef6\u5305\uff081.24\u540e\u7248\u672c\u63a8\u8350\uff09", "text": "<p>\u6dfb\u52a0\u963f\u91cc\u4e91docker-ce\u4ed3\u5e93\uff08containerd\u8f6f\u4ef6\u5305\u5728docker\u4ed3\u5e93\uff09</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a 'dnf install -y yum-utils &amp;&amp; \\\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo'\n</code></pre> <p>\u5b89\u88c5containerd\u8f6f\u4ef6\u5305</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a 'dnf install -y containerd.io-1.6.20-3.1.el9.x86_64'\n</code></pre> <p>\u751f\u6210containerd\u914d\u7f6e\u6587\u4ef6 \u7531\u4e8e\u539f\u672c\u7684\u914d\u7f6e\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5\u7528\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u751f\u6210</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a'containerd config default | tee /etc/containerd/config.toml'\n</code></pre> <p>\u542f\u7528Cgroup\u7528\u4e8e\u9650\u5236\u8fdb\u7a0b\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\uff0c\u5982CPU\u3001\u5185\u5b58\u8d44\u6e90</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a \"sed -i 's#SystemdCgroup = false#SystemdCgroup = true#' /etc/containerd/config.toml\"\n</code></pre> <p>\u66ff\u6362\u6587\u4ef6\u4e2dpause\u955c\u50cf\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\u963f\u91cc\u4e91\u4ed3\u5e93</p> <pre><code>#\u5982\u679c\u9047\u5230\u5f15\u53f7\u592a\u591a\u7684\u60c5\u51b5\u53ef\u4ee5\u5199\u8fdb\u4e00\u4e2ashell\u811a\u672c\uff0c\u7136\u540eansible\u6267\u884c\n[root@master01 cluster-k8s]# cat image.sh \nsed -i 's#sandbox_image = \"registry.k8s.io/pause:3.6\"#sandbox_image = \"registry.aliyuncs.com/google_containers/pause:3.9\"#' /etc/containerd/config.toml\n[root@master01 cluster-k8s]# ansible k8s -m script -a \"image.sh\"\n</code></pre> <p>\u4e3aContainerd\u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668\uff0c\u5728\u6587\u4ef6\u4e2d\u627e\u5230<code>[plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors]</code>\uff0c\u5728\u4e0b\u65b9\u6dfb\u52a0\u955c\u50cf\u52a0\u901f\u5668</p> <pre><code>vim crictl.yaml           #\u76f4\u63a5\u590d\u5236\u5230\u5f53\u524d\u76ee\u5f55\u4fee\u6539\u597d\n\n155       [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors]\n156         [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors.\"docker.io\"]157            endpoint = [\"https://docker.m.daocloud.io\", \"https://noohub.ru\", \"https://huecker.io\", \"https://dockerhub.timeweb.cloud\"]\n\n[root@master01 cluster-k8s]# ansible k8s -m copy -a 'src=config.toml dest=/etc/containerd'       \n</code></pre> <p>\u6307\u5b9acontaienrd\u63a5\u53e3\u6587\u4ef6\u5730\u5740\uff0c\u5728k8s\u73af\u5883\u4e2d\uff0ckubelet\u901a\u8fc7 <code>containerd.sock</code> \u6587\u4ef6\u4e0econtainerd\u8fdb\u884c\u901a\u4fe1</p> <pre><code>[root@master01 cluster-k8s]# cat crictl.yaml    #\u540d\u5b57\u4e0d\u80fd\u53d8\uff01\nruntime-endpoint: unix:///var/run/containerd/containerd.sock\nimage-endpoint: unix:///var/run/containerd/containerd.sock\ntimeout: 10\ndebug: false\n\n[root@master01 cluster-k8s]# ansible k8s -m copy -a 'src=crictl.yaml dest=/etc/'\n\n#\u53c2\u6570\u4ecb\u7ecd\nruntime-endpoint        //\u6307\u5b9a\u4e86\u5bb9\u5668\u8fd0\u884c\u65f6\u7684sock\u6587\u4ef6\u4f4d\u7f6e\nimage-endpoint      //\u6307\u5b9a\u4e86\u5bb9\u5668\u955c\u50cf\u4f7f\u7528\u7684sock\u6587\u4ef6\u4f4d\u7f6e\ntimeout             //\u5bb9\u5668\u8fd0\u884c\u65f6\u6216\u5bb9\u5668\u955c\u50cf\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\u8d85\u65f6\u65f6\u95f4\ndebug               //\u6307\u5b9a\u4e86crictl\u5de5\u5177\u7684\u8c03\u8bd5\u6a21\u5f0f,false\u8868\u793a\u8c03\u8bd5\u6a21\u5f0f\u672a\u542f\u7528,true\u5219\u4f1a\u5728\u8f93\u51fa\u4e2d\u5305\u542b\u66f4\u591a\u7684\u8c03\u8bd5\u65e5\u5fd7\u4fe1\u606f\uff0c\u6709\u52a9\u4e8e\u6545\u969c\u6392\u9664\u548c\u95ee\u9898\u8c03\u8bd5\n</code></pre> <p>\u542f\u52a8containerd\u5e76\u8bbe\u7f6e\u968f\u673a\u81ea\u542f</p> <pre><code>[root@master01 cluster-k8s]# ansible k8s -m shell -a 'systemctl enable containerd --now'\n</code></pre> <p>\u5982\u679c\u6709\u62a5\u9519\u53ef\u4ee5\u67e5\u770b  \u4f1a\u63d0\u793a\u54ea\u91cc\u62a5\u9519</p> <pre><code>containerd config dump\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#k8s", "title": "k8s\u96c6\u7fa4\u90e8\u7f72\u65b9\u5f0f", "text": "<p>kubernetes\u96c6\u7fa4\u6709\u591a\u79cd\u90e8\u7f72\u65b9\u5f0f\uff0c\u76ee\u524d\u5e38\u7528\u7684\u90e8\u7f72\u65b9\u5f0f\u6709\u5982\u4e0b\u4e24\u79cd\uff1a</p> <ul> <li> <p>kubeadm\u90e8\u7f72\u65b9\u5f0f\uff1akubeadm\u662f\u4e00\u4e2a\u5feb\u901f\u642d\u5efakubernetes\u7684\u96c6\u7fa4\u5de5\u5177\uff1b</p> </li> <li> <p>\u4e8c\u8fdb\u5236\u5305\u90e8\u7f72\u65b9\u5f0f\uff1a\u4ece\u5b98\u7f51\u4e0b\u8f7d\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u4e8c\u8fdb\u5236\u5305\uff0c\u4f9d\u6b21\u53bb\u5b89\u88c5\uff0c\u90e8\u7f72\u9ebb\u70e6\uff1b</p> </li> <li> <p>\u5176\u4ed6\u65b9\u5f0f\uff1a\u901a\u8fc7\u4e00\u4e9b\u5f00\u6e90\u7684\u5de5\u5177\u642d\u5efa\uff0c\u4f8b\u5982\uff1asealos\uff1b</p> </li> </ul> <p>\u914d\u7f6ekubeadm\u4ed3\u5e93\uff0c\u672c\u5b9e\u9a8c\u4f7f\u7528\u963f\u91cc\u4e91YUM\u6e90</p> <pre><code>cat k8s.repo \n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\nenabled=1\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\n\n[root@master01 cluster-k8s]# ansible k8s -m shell -a'src=k8s.repo dest=/etc/yum.repos.d/'\n[root@master01 cluster-k8s]# ansible k8s -m shell -a 'yum clean all &amp;&amp; yum makecache -y '\n</code></pre> <p>\u5b89\u88c5\u4ee5\u4e0b\u8f6f\u4ef6\u5305\uff1a</p> <ul> <li> <p>kubeadm\uff1a\u7528\u4e8e\u521d\u59cb\u5316\u96c6\u7fa4\uff0c\u5e76\u914d\u7f6e\u96c6\u7fa4\u6240\u9700\u7684\u7ec4\u4ef6\u5e76\u751f\u6210\u5bf9\u5e94\u7684\u5b89\u5168\u8bc1\u4e66\u548c\u4ee4\u724c\uff1b</p> </li> <li> <p>kubelet\uff1a\u8d1f\u8d23\u4e0e Master \u8282\u70b9\u901a\u4fe1\uff0c\u5e76\u6839\u636e Master \u8282\u70b9\u7684\u8c03\u5ea6\u51b3\u7b56\u6765\u521b\u5efa\u3001\u66f4\u65b0\u548c\u5220\u9664 Pod\uff0c\u540c\u65f6\u7ef4\u62a4 Node \u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u72b6\u6001\uff1b</p> </li> <li> <p>kubectl\uff1a\u7528\u4e8e\u7ba1\u7406k8\u96c6\u7fa4\u7684\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff1b</p> </li> </ul> <pre><code>dnf install -y kubeadm     #\u5b89\u88c5\u4e00\u4e2a\uff0c\u5176\u4ed6\u4fe9\u4e2a\u4f1a\u88ab\u5f53\u6210\u4f9d\u8d56\u81ea\u52a8\u5b89\u88c5\uff0c\u9ed8\u8ba4\u6700\u65b0\u7248\u672c\n</code></pre> <p>kubelet\u542f\u7528Cgroup\u63a7\u5236\u7ec4\uff0c\u7528\u4e8e\u9650\u5236\u8fdb\u7a0b\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\uff0c\u5982CPU\u3001</p> <pre><code>tee &gt; /etc/sysconfig/kubelet &lt;&lt;EOF\nKUBELET_EXTRA_ARGS=\"--cgroup-driver=systemd\"\nEOF\n</code></pre> <p>kubelet\u542f\u7528Cgroup\u63a7\u5236\u7ec4\uff0c\u7528\u4e8e\u9650\u5236\u8fdb\u7a0b\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\uff0c\u5982CPU\u3001\u5185\u5b58 \u7136\u540e\u81ea\u542f</p> <pre><code>[root@master01 cluster-k8s]# cat /etc/sysconfig/kubelet \nKUBELET_EXTRA_ARGS=\"--cgroup-driver=systemd\"\n[root@master01 cluster-k8s]# ansible k8s -m copy -a 'src=./kubelet dest=/etc/sysconfig/'\n[root@master01 cluster-k8s]# ansible k8s -m shell -a 'systemctl enable kubelet'\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#_2", "title": "\u96c6\u7fa4\u521d\u59cb\u5316", "text": "<p>\u5728master01\u8282\u70b9\u67e5\u770b\u96c6\u7fa4\u6240\u9700\u955c\u50cf\u6587\u4ef6</p> <pre><code>kubeadm config images list\n\n#...\u4ee5\u4e0b\u662f\u96c6\u7fa4\u521d\u59cb\u5316\u6240\u9700\u7684\u96c6\u7fa4\u7ec4\u4ef6\u955c\u50cf\nv1.27.1; falling back to: stable-1.23\nk8s.gcr.io/kube-apiserver:v1.23.17\nk8s.gcr.io/kube-controller-manager:v1.23.17\nk8s.gcr.io/kube-scheduler:v1.23.17\nk8s.gcr.io/kube-proxy:v1.23.17\nk8s.gcr.io/pause:3.6\nk8s.gcr.io/etcd:3.5.1-0\nk8s.gcr.io/coredns/coredns:v1.8.6\n</code></pre> <p>\u5728master01\u8282\u70b9\u751f\u6210\u521d\u59cb\u5316\u96c6\u7fa4\u7684\u914d\u7f6e\u6587\u4ef6</p> <pre><code>kubeadm config print init-defaults &gt; kubeadm-config.yaml\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u4fee\u6539\u5982\u4e0b\u5185\u5bb9</p> <pre><code>#\u7ba1\u7406\u8282\u70b9\u7684IP\u5730\u5740\nadvertiseAddress: 192.168.3.121\n\n#\u672c\u673a\u6ce8\u518c\u5230\u96c6\u7fa4\u540e\u7684\u8282\u70b9\u540d\u79f0\nname: master01\n\n#\u96c6\u7fa4\u955c\u50cf\u4e0b\u8f7d\u5730\u5740\uff0c\u4fee\u6539\u4e3a\u963f\u91cc\u4e91\nimageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers\n</code></pre> <p>\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u521d\u59cb\u5316\u96c6\u7fa4</p> <pre><code>kubeadm init --config kubeadm-config.yaml \n</code></pre> <p>\u6839\u636e\u96c6\u7fa4\u521d\u59cb\u5316\u540e\u7684\u63d0\u793a\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4</p> <pre><code>mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre> <p>\u6839\u636e\u63d0\u793a\u5c06node\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\uff0c\u52a0\u5165\u6210\u529f\u540e\u5728master\u8282\u70b9\u9a8c\u8bc1</p> <pre><code>[root@master01 ~]# kubectl get no\nNAME       STATUS     ROLES           AGE   VERSION\nmaster01   NotReady   control-plane   20m   v1.28.2\nnode1      NotReady   &lt;none&gt;          11m   v1.28.2\nnode2      NotReady   &lt;none&gt;          19m   v1.28.2\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#calico", "title": "\u90e8\u7f72\u96c6\u7fa4\u7f51\u7edcCalico", "text": "<p>Calico \u548c Flannel \u662f\u4e24\u79cd\u6d41\u884c\u7684 k8s \u7f51\u7edc\u63d2\u4ef6\uff0c\u5b83\u4eec\u90fd\u4e3a\u96c6\u7fa4\u4e2d\u7684 Pod \u63d0\u4f9b\u7f51\u7edc\u529f\u80fd\u3002\u7136\u800c\uff0c\u5b83\u4eec\u5728\u5b9e\u73b0\u65b9\u5f0f\u548c\u529f\u80fd\u4e0a\u6709\u4e00\u4e9b\u91cd\u8981\u533a\u522b\uff1a</p> <p>\u7f51\u7edc\u6a21\u578b\u7684\u533a\u522b\uff1a</p> <ul> <li> <p>Calico \u4f7f\u7528 BGP\uff08\u8fb9\u754c\u7f51\u5173\u534f\u8bae\uff09\u4f5c\u4e3a\u5176\u5e95\u5c42\u7f51\u7edc\u6a21\u578b\u3002\u5b83\u5229\u7528 BGP \u4e3a\u6bcf\u4e2a Pod \u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684 IP \u5730\u5740\uff0c\u5e76\u5728\u96c6\u7fa4\u5185\u90e8\u8fdb\u884c\u8def\u7531\u3002Calico \u652f\u6301\u7f51\u7edc\u7b56\u7565\uff0c\u53ef\u4ee5\u5bf9\u6d41\u91cf\u8fdb\u884c\u7cbe\u7ec6\u63a7\u5236\uff0c\u5141\u8bb8\u6216\u62d2\u7edd\u7279\u5b9a\u7684\u901a\u4fe1\u3002</p> </li> <li> <p>Flannel \u5219\u91c7\u7528\u4e86\u4e00\u4e2a\u7b80\u5316\u7684\u8986\u76d6\u7f51\u7edc\u6a21\u578b\u3002\u5b83\u4e3a\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u4e00\u4e2a IP \u5730\u5740\u5b50\u7f51\uff0c\u7136\u540e\u5728\u8fd9\u4e9b\u5b50\u7f51\u4e4b\u95f4\u5efa\u7acb\u8986\u76d6\u7f51\u7edc\u3002Flannel \u5c06 Pod \u7684\u6570\u636e\u5305\u5c01\u88c5\u5230\u4e00\u4e2a\u66f4\u5927\u7684\u7f51\u7edc\u6570\u636e\u5305\u4e2d\uff0c\u5e76\u5728\u8282\u70b9\u4e4b\u95f4\u8fdb\u884c\u8f6c\u53d1\u3002Flannel \u66f4\u6ce8\u91cd\u7b80\u5355\u548c\u6613\u7528\u6027\uff0c\u4e0d\u63d0\u4f9b\u4e0e Calico \u7c7b\u4f3c\u7684\u7f51\u7edc\u7b56\u7565\u529f\u80fd\u3002</p> </li> </ul> <p>\u6027\u80fd\u7684\u533a\u522b\uff1a</p> <ul> <li> <p>\u7531\u4e8e Calico \u4f7f\u7528 BGP \u8fdb\u884c\u8def\u7531\uff0c\u5176\u6027\u80fd\u901a\u5e38\u4f18\u4e8e Flannel\u3002Calico \u53ef\u4ee5\u5b9e\u73b0\u76f4\u63a5\u7684 Pod \u5230 Pod \u901a\u4fe1\uff0c\u800c\u65e0\u9700\u5728\u8282\u70b9\u4e4b\u95f4\u8fdb\u884c\u989d\u5916\u7684\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\u64cd\u4f5c\u3002\u8fd9\u4f7f\u5f97 Calico \u5728\u5927\u578b\u6216\u9ad8\u5ea6\u52a8\u6001\u7684\u96c6\u7fa4\u4e2d\u5177\u6709\u66f4\u597d\u7684\u6027\u80fd\u3002</p> </li> <li> <p>Flannel \u7684\u8986\u76d6\u7f51\u7edc\u6a21\u578b\u4f1a\u5bfc\u81f4\u989d\u5916\u7684\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\u5f00\u9500\uff0c\u4ece\u800c\u5f71\u54cd\u7f51\u7edc\u6027\u80fd\u3002\u5bf9\u4e8e\u8f83\u5c0f\u7684\u96c6\u7fa4\u6216\u5bf9\u6027\u80fd\u8981\u6c42\u4e0d\u9ad8\u7684\u573a\u666f\uff0c\u8fd9\u53ef\u80fd\u5e76\u4e0d\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\u3002</p> </li> </ul> <p>master01\u8282\u70b9\u4e0b\u8f7dCalico\u6587\u4ef6</p> <pre><code>wget https://raw.githubusercontent.com/projectcalico/calico/v3.24.1/manifests/calico.yaml\n\nvi calico.yaml\n# \u4fee\u6539\u914d\u7f6e \u6587\u4ef6CALICO_IPV4POOL_CIDR \u53c2\u6570 \u8981\u4e0e\u2013pod-network-cidr \u6307\u5b9a\u4e00\u81f4\n- name: CALICO_IPV4POOL_CIDR\n  value: \"10.244.0.0/16\"\n#\u521b\u5efacalico\u7f51\u7edc\nkubectl apply -f calico.yaml \n#\u67e5\u770bCalico Pod\u72b6\u6001\u662f\u5426\u4e3aRunning\nkubectl get pod -n kube-system\n\n#\u4f1a\u6709\u70b9\u6162\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/ansible%E9%83%A8%E7%BD%B21.28.2%E9%9B%86%E7%BE%A4%28Containerd%29/#nginx", "title": "\u9a8c\u8bc1\u96c6\u7fa4\u8282\u70b9\u72b6\u6001 \u90e8\u7f72Nginx\u6d4b\u8bd5\u96c6\u7fa4", "text": "<pre><code>\u5728master01\u8282\u70b9\u90e8\u7f72nginx\u7a0b\u5e8f\u6d4b\u8bd5\nvim nginx-test.yml\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  containers:\n  - name: nginx\n    image: nginx:1.20.2\n    ports:\n    - containerPort: 80\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-svc\nspec:\n  type: NodePort\n  selector:\n    app: nginx\n  ports:\n    - name: http\n      protocol: TCP\n      port: 80\n      targetPort: 80\n      nodePort: 30002\n</code></pre> <p>\u67e5\u770bPod\u72b6\u6001\u662f\u5426\u4e3aRunning</p> <pre><code>[root@master01 ~]# kubectl get pod\nNAME                         READY   STATUS    RESTARTS   AGE\nng-deploy-65f87c8579-4zmv2   1/1     Running   0          2m19s\nng-deploy-65f87c8579-cgtzq   1/1     Running   0          2m19s\n</code></pre> <p>\u67e5\u770bService\u4ee3\u7406\u4fe1\u606f</p> <pre><code>[root@master01 ~]# kubectl  get svc\nNAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE\nkubernetes   ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP   40m\nng-svc       ClusterIP   10.107.218.212   &lt;none&gt;        80/TCP    2m49s\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/mysql8.0%20%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/", "title": "mysql8.0 \u5feb\u901f\u642d\u5efa", "text": ""}, {"location": "%E8%B5%84%E6%96%99/mysql8.0%20%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/#mysql80_1", "title": "\u5b89\u88c5mysql8.0\u4ed3\u5e93", "text": "<pre><code>tee /etc/yum.repos.d/mysql-8.0.repo &lt;&lt;EOF\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=https://repo.mysql.com/yum/mysql-8.0-community/el/9/x86_64/\nenabled=1\ngpgcheck=0\nEOF\n</code></pre> <p>\u53ef\u4ee5\u67e5\u770b\u6570\u636e\u5e93\u7684\u5177\u4f53\u7684\u7248\u672c</p> <pre><code>dnf search mysql-community-server --showduplicates | grep 8.0\n</code></pre> <p>\u5b89\u88c58.0\u7248\u672c</p> <pre><code>dnf install -y mysql-community-server-8.0.30-1.el9.x86_64\n</code></pre> <p>\u542f\u52a8\u6570\u636e\u5e93</p> <pre><code>systemctl enable mysqld --now\n</code></pre> <p>\u8fc7\u6ee4\u6570\u636e\u5e93\u521d\u59cbroot\u5bc6\u7801</p> <pre><code>grep \"password\" /var/log/mysqld.log\n</code></pre> <p>\u4f7f\u7528\u521d\u59cb\u5bc6\u7801\u767b\u5f55</p> <pre><code>mysql -u root -p\"9VZ&lt;oQcwi=qL\"\n</code></pre> <p>\u4fee\u6539\u6570\u636e\u5e93root\u5bc6\u7801</p> <pre><code>mysql&gt; alter user root@\"localhost\" identified by \"Admin123...\";\n</code></pre> <p>\u9000\u51fa\u6570\u636e\u5e93\u7528\u65b0\u5bc6\u7801\u767b\u5f55</p> <pre><code>mysql -uroot -p'Admin123...'\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/openstack/", "title": "OpenStack", "text": "<p>OpenStack PDF</p> <p>openstack pdf \u5185\u5bb9\uff1a</p>  This browser does not support PDFs"}, {"location": "%E8%B5%84%E6%96%99/rocky%20linux%20%E9%83%A8%E7%BD%B2zabbix/", "title": "rocky linux \u90e8\u7f72zabbix", "text": ""}, {"location": "%E8%B5%84%E6%96%99/rocky%20linux%20%E9%83%A8%E7%BD%B2zabbix/#zabbix70", "title": "zabbix7.0\u5b89\u88c5", "text": "<p>\u6ce8\u610fcentos 7 \u597d\u50cf\u53ea\u80fd\u5b89\u88c55.0\u7248\u672c LTS\u8868\u793a\u957f\u671f\u652f\u6301\u7248\u672c </p> <p>\u5b89\u88c5zabbix7.0\u4ed3\u5e93</p> <pre><code>[root@zabbix-server~]# rpm -Uvh https://repo.zabbix.com/zabbix/7.0/rocky/9/x86_64/zabbix-release-7.0-5.el9.noarch.rpm\n</code></pre> <p>\u5b89\u88c5zabbix\u76f8\u5173\u5b89\u88c5\u5305</p> <pre><code>[root@zabbix-server ~]# dnf install -y zabbix-server-mysql zabbix-web-mysql zabbix-nginx-conf zabbix-sql-scripts zabbix-selinux-policy zabbix-agent gd-devel\n</code></pre> <p>\u6dfb\u52a0mysql8.0 \u4ed3\u5e93</p> <pre><code>tee /etc/yum.repos.d/mysql-8.0.repo &lt;&lt;EOF\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=https://repo.mysql.com/yum/mysql-8.0-community/el/9/x86_64/\nenabled=1\ngpgcheck=0\nEOF\n</code></pre> <p>\u5b89\u88c5mysql8.0\u7248\u672c</p> <pre><code>dnf install -y mysql-community-server-8.0.30-1.el9.x86_64\n</code></pre> <p>\u542f\u52a8\u6570\u636e\u5e93</p> <pre><code>systemctl enable mysqld --now\n</code></pre> <p>\u627e\u5230\u521d\u59cb\u5bc6\u7801</p> <pre><code>grep \"password\" /var/log/mysqld.log\n</code></pre> <p>\u4f7f\u7528\u521d\u59cb\u5bc6\u7801\u767b\u5f55\u6570\u636e\u5e93\uff0c\u683c\u5f0f\uff1a <code>mysql -u \u7528\u6237\u540d -p\u5bc6\u7801</code>\uff08 -p\u4e0e\u5bc6\u7801\u4e4b\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5176\u4ed6\u53c2\u6570\u53ef\u6709\u53ef\u65e0\uff0c\u5bc6\u7801\u5982\u679c\u6709\u7279\u6b8a\u5b57\u7b26\u9700\u8981\u7528\u5f15\u8d77\u6765\uff09</p> <pre><code>mysql -uroot -p\"s.I=f5mtx&amp;Me\"      #-u\u548c-p\u540e\u9762\u4e0d\u8981\u6709\u7a7a\u683c\n</code></pre> <p>\u8fdb\u5165\u6570\u636e\u5e93\u91cd\u65b0\u4fee\u6539root\u5bc6\u7801</p> <pre><code>alter user root@\"localhost\" identified by \"Admin123...\";\n</code></pre> <p>\u9000\u51fa\u6570\u636e\u5e93\u5e76\u4e14\u7528\u65b0\u5bc6\u7801\u767b\u5f55</p> <pre><code>[root@zabbix-server ~]# mysql -uroot -pAdmin123...\n</code></pre> <p>\u521b\u5efazabbix\u5e93\u4e0e\u7528\u6237</p> <pre><code># \u521b\u5efa\u540d\u4e3a zabbix \u7684\u6570\u636e\u5e93\uff0c\u4f7f\u7528 utf8mb4 \u5b57\u7b26\u96c6\u548c utf8mb4_bin \u6392\u5e8f\u89c4\u5219\nCREATE DATABASE zabbix CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;\n\n# \u521b\u5efa\u7528\u6237 zabbix\uff0c\u5e76\u8bbe\u7f6e\u5bc6\u7801\u4e3a 'zbx123...A'\uff0c\u9650\u5236\u8be5\u7528\u6237\u53ea\u80fd\u4ece\u672c\u5730\u8bbf\u95ee\nCREATE USER zabbix@localhost IDENTIFIED BY 'zbx123...A';\n\n# \u6388\u4e88\u7528\u6237 zabbix \u5bf9 zabbix \u6570\u636e\u5e93\u7684\u6240\u6709\u6743\u9650\nGRANT ALL PRIVILEGES ON zabbix.* TO zabbix@localhost;\n\n# \u5141\u8bb8\u5728\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e2d\u4fe1\u4efb\u51fd\u6570\u521b\u5efa\u8005\uff0c\u907f\u514d\u51fd\u6570\u521b\u5efa\u65f6\u7684\u6743\u9650\u95ee\u9898\nSET GLOBAL log_bin_trust_function_creators = 1;\n\n# \u5237\u65b0\u914d\u7f6e\nflush privileges;\n</code></pre> <p>\u9000\u51fa\u6570\u636e\u5e93\uff0c\u5bfc\u5165\u6570\u636e\u5e93\u6240\u9700\u7684\u8868\u6587\u4ef6</p> <pre><code>cd /usr/share/zabbix-sql-scripts/mysql\n\n[root@zabbix-server mysql]# zcat  server.sql.gz | mysql -uroot -pAdmin123... zabbix\nmysql: [Warning] Using a password on the command line interface can be insecure.\n# \u8fd9\u91cc\u53ea\u662f\u4e00\u4e2a\u8b66\u544a\uff0c\u4e0d\u7528\u7ba1\n</code></pre> <p>\u7136\u540e\u9700\u8981\u8fdb\u5165\u6570\u636e\u5e93\u7981\u7528log_bin_trust_function_creators</p> <pre><code>mysql -uroot -p'Admin123...'\nset global log_bin_trust_function_creators = 0;\n</code></pre> <p>\u4e3azabbix server \u914d\u7f6e\u8fde\u63a5\u6570\u636e\u5e93</p> <pre><code>[root@zabbix-server ~]# vim /etc/zabbix/zabbix_server.conf \n#zabbix\u4f7f\u7528\u7684\u6570\u636e\u5e93\u540d\u79f0\nDBName=zabbix\n\n#zabbix\u8fde\u63a5\u6570\u636e\u5e93\u7528\u6237\u540d\u79f0\nDBUser=zabbix\n\n#\u7528\u6237\u5bc6\u7801\nDBPassword=zbx123...A   #\u8fd9\u4e2a\u5bc6\u7801\u662fzbbix\u6570\u636e\u5e93\u7684\u5bc6\u7801\n</code></pre> <p>\u5b89\u88c5zabbix\u4e2d\u6587\u5305\uff08\u9ed8\u8ba4zabbix web\u9875\u9762\u4e0d\u652f\u6301\u4e2d\u6587\uff09</p> <pre><code>dnf install  glibc-langpack-zh.x86_64 -y  #\u9700\u8981\u5b89\u88c5\u8fd9\u4e2a\uff0c\u524d\u7aef\u9009\u62e9\u8bed\u8a00\u624d\u6709\u4e2d\u6587\n</code></pre> <p>\u542f\u52a8zabbix\u76f8\u5173\u670d\u52a1</p> <pre><code>systemctl restart zabbix-server zabbix-agent nginx php-fpm\nsystemctl enable zabbix-server zabbix-agent nginx php-fpm\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/rocky%20linux%20%E9%83%A8%E7%BD%B2zabbix/#zabbix", "title": "\u914d\u7f6ezabbix\u524d\u7aef", "text": "<p>\u8fd9\u91cc\u9700\u8981\u5168\u90e8\u663e\u793aok</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u6210\u529f\u8fdb\u5165</p>"}, {"location": "%E8%B5%84%E6%96%99/rocky%20linux%20%E9%83%A8%E7%BD%B2zabbix/#zabbix-agent", "title": "\u51c6\u5907zabbix-agent", "text": "<p>zabbix-agent \u5b89\u88c57.0\u4ed3\u5e93</p> <pre><code>[root@zabbix-agent ~]# rpm -Uvh https://repo.zabbix.com/zabbix/7.0/rocky/9/x86_64/zabbix-release-7.0-5.el9.noarch.rpm\n</code></pre> <p>\u5b89\u88c5zabbix-agent\u5305</p> <pre><code>dnf install -y zabbix-agent \n</code></pre> <p>\u4fee\u6539zabbix-agent\u914d\u7f6e\u6587\u4ef6\uff0c\u6307\u5b9azabbix-server\u4e3b\u673a\u5730\u5740</p> <p>[root@zabbix-agent ~]#  vim /etc/zabbix/zabbix_agentd.conf</p> <p></p> <p>\u542f\u52a8zabbix-agent</p> <pre><code>systemctl enable zabbix-agent --now\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/rocky%20linux%20%E9%83%A8%E7%BD%B2zabbix/#zabbix_1", "title": "zabbix\u6dfb\u52a0\u4e3b\u673a", "text": "<p>\u5728 \u3010\u6570\u636e\u91c7\u96c6\u3011-\u3010\u4e3b\u673a\u3011-\u3010\u521b\u5efa\u4e3b\u673a\u3011 \u4e2d\u6dfb\u52a0\u4e3b\u673a\u4fe1\u606f</p> <p></p> <p></p> <p>\u4fee\u6539\u5b57\u4f53\u4e71\u7801</p> <pre><code># \u8fd9\u91cc\u9009\u62e9win\u7535\u8111\u7684 C:\\Windows\\Fonts \u590d\u5236\u4e00\u4e2a\u91cc\u9762\u7684\u5b57\u4f53\n# \u4e0a\u4f20\u9009\u62e9\u7684\u5b57\u4f53\n[root@zabbix-server fonts]# ls\nSIMSUN.TTC  graphfont.ttf  zabbix-icons.svg  zabbix-icons.ttf  zabbix-icons.woff  zabbix-icons.woff2\n[root@zabbix-server fonts]# cp SIMSUN.TTC graphfont.ttf \ncp: overwrite 'graphfont.ttf'? y  #\u8986\u76d6\u4e00\u4e0b\n[root@zabbix-server fonts]# rm -rf SIMSUN.TTC  # \u7136\u540e\u5220\u9664\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/", "title": "shell \u5b66\u4e60", "text": ""}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#shell_1", "title": "shell\u7684\u6982\u5ff5", "text": ""}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#shell_2", "title": "shell \u7684\u4f5c\u7528\u662f", "text": "<ul> <li>\u89e3\u91ca\u6267\u884c\u7528\u6237\u8f93\u5165\u7684\u547d\u4ee4\u6216\u7a0b\u5e8f\u7b49</li> <li>\u7528\u6237\u8f93\u5165\u4e00\u6761\u547d\u4ee4\uff0cshell\u5c31\u4ecb\u7ecd\u4e00\u6761</li> <li>\u952e\u76d8\u8f93\u5165\u547d\u4ee4,linux\u7ed9\u76f8\u5e94\u7684\u65b9\u5f0f\uff0c\u79f0\u4e4b\u4e3a\u4ea4\u4e92\u5f0f</li> <li>windows\u4e2d\u7528 *.bat  \u5904\u7406\u811a\u672c</li> <li>Linux\u4e2d\u7528 *.sh \u5904\u7406\u811a\u672c</li> </ul>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#shebang", "title": "Shebang", "text": "<p>\u8ba1\u7b97\u673a\u7a0b\u5e8f\u4e2d\uff0c shebang \u6307\u7684\u662f\u51fa\u73b0\u5728\u6587\u672c\u6587\u4ef6\u7684\u7b2c\u4e00\u884c\u524d\u4fe9\u4e2a\u5b57\u7b26  #!</p> <p>\u5728 Unix \u7cfb\u7edf\u4e2d\uff0c\u7a0b\u5e8f\u56de\u5206\u6790 shebang \u540e\u9762\u7684\u5185\u5bb9\uff0c\u4f5c\u4e3a\u89e3\u91ca\u5668\u7684\u6307\u4ee4\uff0c\u4f8b\u5982</p> <ul> <li>\u4ee5 #!/bin/sh \u5f00\u5934\u7684\u6587\u4ef6\uff0c\u7a0b\u5e8f\u5728\u6267\u884c\u7684\u65f6\u5019\u4f1a\u8c03\u7528 /bin/sh, \u4e5f\u5c31\u662fbash\u89e3\u91ca\u5668</li> <li>\u4ee5 #!/user/bin/python \u5f00\u5934\u7684\u6587\u4ef6\uff0c\u4ee3\u8868\u6307\u5b9apython\u63a5\u6536\u5668\u53bb\u6267\u884c</li> <li>\u4ee5 #!/user/bin/env \u89e3\u91ca\u5668\u540d\u79f0 , \u662f\u4e00\u79cd\u5728\u4e0d\u540c\u5e73\u53f0\u4e0a\u90fd\u80fd\u6b63\u786e\u627e\u5230\u89e3\u91ca\u5668\u7684\u65b9\u6cd5</li> </ul> <p>\u67e5\u770bshell</p> <pre><code>[root@localhost ~]# cat /etc/shells #\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u6709\u54ea\u4e9b\u53ef\u7528\u7684shell\n/bin/sh\n/bin/bash\n/usr/bin/sh\n/usr/bin/bash\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#cron", "title": "cron\u8868\u8fbe\u5f0f\u7ed3\u6784", "text": "<pre><code>* * * * * /path/to/command\n| | | | |\n| | | | +----- \u661f\u671f\u51e0 (0 - 7) (0 \u548c 7 \u90fd\u8868\u793a\u661f\u671f\u65e5)\n| | | +------- \u6708\u4efd (1 - 12)\n| | +--------- \u65e5\u671f (1 - 31)\n| +----------- \u5c0f\u65f6 (0 - 23)\n+------------- \u5206\u949f (0 - 59)\n</code></pre> <p>*\u7684\u542b\u4e49</p> <pre><code>* \u8868\u793a\u4efb\u610f\u503c\uff0c\u5373\u5339\u914d\u6240\u6709\u53ef\u80fd\u7684\u503c\n\u4f8b\u5982\uff1a\n* * * * *\uff1a\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\u3002\n\n0 * * * *\uff1a\u6bcf\u5c0f\u65f6\u7684\u6574\u70b9\u6267\u884c\u4e00\u6b21\u3002\n\n0 2 * * *\uff1a\u6bcf\u5929\u51cc\u6668 2 \u70b9\u6267\u884c\u4e00\u6b21\u3002\n</code></pre> <p>\u5176\u4ed6\u5e38\u7528\u7b26\u53f7\u7528\u6cd5</p> <p>, (\u9017\u53f7)  \u8868\u793a\u591a\u4e2a\u503c</p> <pre><code>\u4f8b\u5982\uff1a0 2,14 * * * \u8868\u793a\u6bcf\u5929\u51cc\u6668 2 \u70b9\u548c\u4e0b\u5348 2 \u70b9\u6267\u884c\u3002\n</code></pre> <p>-(\u8fde\u5b57\u7b26)   \u8868\u793a\u4e00\u4e2a\u8303\u56f4</p> <pre><code>\u4f8b\u5982\uff1a0 8-18 * * * \u8868\u793a\u6bcf\u5929 8 \u70b9\u5230 18 \u70b9\u4e4b\u95f4\uff0c\u6bcf\u5c0f\u65f6\u6267\u884c\u4e00\u6b21\u3002\n</code></pre> <p>/  (\u659c\u6760) \u8868\u793a\u95f4\u9694</p> <pre><code>\u4f8b\u5982\uff1a*/5 * * * * \u8868\u793a\u6bcf 5 \u5206\u949f\u6267\u884c\u4e00\u6b21\u3002\n</code></pre> <p>?  (\u95ee\u53f7)  \u5728\u65e5\u671f\u548c\u661f\u671f\u51e0\u5b57\u6bb5\u4e2d\uff0c\u8868\u793a \"\u4e0d\u6307\u5b9a\u503c\"</p> <pre><code>\u4f8b\u5982\uff1a0 2 * * ? \u8868\u793a\u6bcf\u5929\u51cc\u6668 2 \u70b9\u6267\u884c\uff0c\u4e0d\u6307\u5b9a\u661f\u671f\u51e0\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_1", "title": "\u90ae\u4ef6\u53d1\u9001", "text": "<p>mail</p> <pre><code>\u9700\u8981\u5b89\u88c5mail\u5de5\u5177\n\u6bcf\u4e2a\u7cfb\u7edf\u6709\u70b9\u4e0d\u540c\n\u5728 Ubuntu/Debian \u7cfb\u7edf\u4e0a\napt install mailutils\n\u5728 CentOS/RHEL \u7cfb\u7edf\u4e0a\nyum install -y mailx\n\n\u9700\u8981\u4fee\u6539\u914d\u7f6e\uff0c\u6dfb\u52a0\u53d1\u9001\u90ae\u7bb1\nvi /etc/mail.rc\nset from=zhangbaojingtz@163.com  #\u90ae\u7bb1\u8d26\u53f7      smtp=smtp.163.com\nset smtp-auth-user=zhangbaojingtz@163.com  smtp-auth-password= #\u8fd9\u91cc\u9700\u8981\u6388\u6743\u7801\nset smtp-auth=login\n\necho \"\u90ae\u4ef6\u5185\u5bb9\" | mail -s \"\u90ae\u4ef6\u4e3b\u9898\" 2915597808@qq.com #\u9700\u8981\u53d1\u9001\u5230\u8c01\u7684\u90ae\u7bb1\n#\u6d4b\u8bd5\u5982\u679c\u53d1\u9001qq\u90ae\u7bb1\u7684\u8bdd\u4f1a\u5728\u5783\u573e\u6876\uff0c\u5efa\u8bae\u53d1\u9001\u5176\u4ed6163\u90ae\u7bb1\n</code></pre> <p>163\u90ae\u7bb1\u5f00\u542f\u6388\u6743\u7801</p> <p></p> <p>\u8fdb\u5165163\u90ae\u7bb1\uff0c\u7136\u540e\u70b9\u51fb\u8bbe\u7f6e\u91cc\u9762\u7684POP3/SMTP/IMAP</p> <p></p> <p>\u76f4\u63a5\u5f00\u542f\u7b2c\u4e00\u4e2a\u5c31\u53ef\u4ee5\u4e86\uff0c\u83b7\u53d6\u6388\u6743\u7801\uff0c\u65f6\u9650\u53ea\u6709180\u5929</p> <p>\u53d8\u91cf \u5c0f\u77e5\u8bc6</p> <pre><code>[root@localhost ~]# age=19  xxx    #shell\u53d8\u91cf\u4e0d\u80fd\u7a7a\u683c\n-bash: xxx: command not found\n[root@localhost ~]# age=\"19 xxx\"    #\u53d8\u91cf\u9700\u8981\u7a7a\u683c\u7684\u65f6\u5019\uff0c\u9700\u8981\u52a0\u4e0a\u53cc\u5f15\u53f7\n[root@localhost ~]# echo $age\n19 xxx\n\n#\u53d8\u91cf\u8ffd\u52a0\n[root@localhost ~]# age=321321\n[root@localhost ~]# echo $age\n321321\n[root@localhost ~]# age=\"$age\"666\n[root@localhost ~]# echo $age\n321321666\n\n#\u5220\u9664\u53d8\u91cf\n[root@localhost ~]# unset age\n[root@localhost ~]# echo $age\n\n#\u4f4d\u7f6e\u4f20\u53c2\n#\u67e5\u770b\u811a\u672c\u5185\u5bb9\n[root@localhost ~]# cat adduser.sh \nuseradd $1\necho $2 | passwd --stdin $1 &amp;&gt;/dev/null\necho \"$1 \u521b\u5efa\u6210\u529f,\u5bc6\u7801\u662f$2\"\n#\u8fd0\u884c\u811a\u672c\n[root@localhost ~]# bash adduser.sh zhangsan 123456\nzhangsan \u521b\u5efa\u6210\u529f,\u5bc6\u7801\u662f123456\n#\u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\n[root@localhost ~]# id zhangsan\nuid=1001(zhangsan) gid=1001(zhangsan) groups=1001(zhangsan)\n</code></pre> <p>\u9884\u5b9a\u4e49\u53d8\u91cf</p> <pre><code>$0  #\u5f53\u524d\u811a\u672c\u540d/\u5f53\u524d\u7a0b\u5e8f\u540d\n$*  #\u6240\u6709\u53c2\u6570-- \u4f60\u4f20\u5165\u591a\u5c11\u4e2a\u503c\u90fd\u4f1a\u6253\u5370\u51fa\u6765\n$#  #\u53c2\u6570\u7684\u4e2a\u6570\uff0c\u4f60\u4f20\u5165\u591a\u5c11\u7ed9\u4ed6\u90fd\u4f1a\u5e2e\u4f60\u7edf\u8ba1\n$?  #\u4e0a\u4e00\u4e2a\u7a0b\u5e8f\u7684\u8fd4\u56de\u503c\uff080\u6210\u529f\uff0c\u975e\u96f6\u5931\u8d25\uff09\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_2", "title": "\u7f16\u5199\u7b80\u6613\u7ec3\u4e60\u811a\u672c", "text": "<pre><code>[root@localhost ~]# cat name.sh \n#!/bin/bash                            #\u6307\u5b9a\u89e3\u91ca\u5668\nread -p \"\u4f60\u53eb\u4ec0\u4e48\u540d\u5b57:\" name\necho \"\u4f60\u597d\u554a, $name\"\n\n[root@localhost ~]# /bin/bash name.sh\n\u4f60\u53eb\u4ec0\u4e48\u540d\u5b57:\u7406\u60f3\u4e61\n\u4f60\u597d\u554a, \u7406\u60f3\u4e61\n\n[root@localhost ~]# chmod +x name.sh  #\u53ef\u4ee5\u6dfb\u52a0\u6267\u884c\u6743\u9650\u5c31\u53ef\u4ee5\u76f4\u63a5\u6267\u884c./name.sh\n[root@localhost ~]# ./name.sh \n\u4f60\u53eb\u4ec0\u4e48\u540d\u5b57:\u7406\u60f3\u4e61\n\u4f60\u597d\u554a, \u7406\u60f3\u4e61\n\n[root@localhost ~]# cat name.py \n#!/user/bin/python3\nprint(\"\u4f60\u597d\u554a\uff0c\u7406\u60f3\u4e61\")\n\n[root@localhost ~]# python3 name.py \n\u4f60\u597d\u554a\uff0c\u7406\u60f3\u4e61\n\n[root@localhost ~]# which python3   \u53ef\u4ee5\u7528wich \u67e5\u627epython3\u7684\u4f4d\u7f6e\n/usr/bin/python3\n\n[root@localhost ~]# cat for.sh \n#!/bin/bash\nfor i in {1..10}\ndo\necho $i;\ndone\n\n[root@localhost ~]# bash for.sh  \n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_3", "title": "\u811a\u672c\u5c0f\u7ec3\u4e60", "text": "<p>\u68c0\u67e5\u670d\u52a1\u5668\u5728\u4e0d\u5728\u7ebf</p> <pre><code>[root@localhost ~]# bash ip.sh \n\u8bf7\u8f93\u5165IP\u5730\u5740:192.168.3.100\n192.168.3.100 down   #\u4e0d\u5728\u7ebf\u4f1a\u6162\u4e00\u70b9\n[root@localhost ~]# bash ip.sh \n\u8bf7\u8f93\u5165IP\u5730\u5740:192.168.3.120\n192.168.3.120 upup\n\n[root@localhost ~]# cat ip.sh \n#!/bin/bash\n#\u8fd9\u662f\u4e00\u4e2a\u68c0\u67e5ip\u5728\u4e0d\u5728\u7ebf\u7684\u811a\u672c\n\nread -p \"\u8bf7\u8f93\u5165IP\u5730\u5740:\" ip\n\nping -c1 $ip &amp;&gt; /dev/null &amp;&amp; echo \"$ip upup\" || echo \"$ip down\"\n</code></pre> <p>\u68c0\u67e5\u4ed3\u5e93\u6709\u6ca1\u6709\u8f6f\u4ef6\u5305</p> <pre><code>[root@localhost ~]# cat search.sh \n#!/bin/bash\n# \u8bfb\u53d6\u7528\u6237\u8f93\u5165\u7684\u8f6f\u4ef6\u5305\u540d\nread -p \"\u8f93\u5165\u4f60\u8981\u67e5\u8be2\u7684\u8f6f\u4ef6\uff1a\" package_name\n\n# \u4f7f\u7528 dnf \u547d\u4ee4\u641c\u7d22\u8f6f\u4ef6\u5305\nif dnf search --cacheonly \"$package_name\" | grep -qw \"$package_name\"; then\n    echo \"\u8f6f\u4ef6\u5305\u5728\u4ed3\u5e93\u4e2d\u5b58\u5728\u3002\"\nelse\n    echo \"\u8f6f\u4ef6\u5305\u5728\u4ed3\u5e93\u4e2d\u4e0d\u5b58\u5728\u3002\"\nfi\n\n[root@localhost ~]# bash search.sh \n\u8f93\u5165\u4f60\u8981\u67e5\u8be2\u7684\u8f6f\u4ef6\uff1amysql\nLast metadata expiration check: 0:53:31 ago on Mon Dec 23 00:10:26 2024.\n\u8f6f\u4ef6\u5305\u5728\u4ed3\u5e93\u4e2d\u5b58\u5728\u3002\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_4", "title": "\u8fd0\u7b97\u7b26", "text": "<pre><code>+ \u52a0\n- \u51cf\n\\* \u4e58 \uff08\\\u9632\u6b62\u8f6c\u4e49-- *\u662f\u5339\u914d\u6240\u6709\uff09\n/ \u9664\n% \u53d6\u4f59\n^ \u6b21\u65b9 2x2x2\n</code></pre> <p>\u65b9\u6cd51</p> <pre><code>[root@localhost ~]# cat num.sh \n#!/bin/bash\nread -p \"\u8bf7\u8f93\u5165\u4f60\u7684\u5206\u6570:\" sum1\nread -p \"\u8bf7\u8f93\u5165\u4f60\u7684\u5206\u6570:\" sum2\nread -p \"\u8bf7\u8f93\u5165\u4f60\u7684\u5206\u6570:\" sum3\necho -n \"\u603b\u5206\u6570: \"\nexpr $sum1 + $sum2 + $sum3\n\n[root@localhost ~]# bash num.sh \n\u8bf7\u8f93\u5165\u4f60\u7684\u5206\u6570:10\n\u8bf7\u8f93\u5165\u4f60\u7684\u5206\u6570:10\n\u8bf7\u8f93\u5165\u4f60\u7684\u5206\u6570:20\n\u603b\u5206\u6570: 40\n\nnum=10\nnum1=10\nexpr $num +$num1\n20\n</code></pre> <p>\u65b9\u6cd52</p> <pre><code>$(())\n\n\u8bed\u6cd5: echo $(($unb1 + $unb2 +$unb3))\n     echo $((1+1*5))\n</code></pre> <p>\u65b9\u6cd53</p> <pre><code>s[]\n\u8bed\u6cd5  echo $[1+2]\n</code></pre> <p>\u5c0f\u6570\u8fd0\u7b97</p> <pre><code>\u9700\u8981\u5b89\u88c5bc\nyum install -y bc   #\u8ba1\u7b97\u5e93\n</code></pre> <pre><code>[root@localhost ~]# echo \"scale=2; 10/3\" | bc    #\u4f592\u4f4d\u6570\uff0c\u4f7f\u7528bc\u5904\u7406\n3.33\n[root@localhost ~]# echo \"scale=5; 10/3\" | bc\n3.33333\n[root@localhost ~]# echo \"scale=3; 10.7 + 3.3\" | bc\n14.0\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_5", "title": "\u903b\u8f91\u5224\u65ad", "text": "<pre><code># \u903b\u8f91\u5224\u65ad\u547d\u4ee4 --\n\n#\u5224\u65ad\u6574\u6570\u7684\u65f6\u5019\u7528\u7684\n-eq \u4e24\u6570\u76f8\u7b49\uff0c\u5219\u4e3a\u771f        \u4f8b\uff1aif [\"$a\" -eq \"$b\" ]  #\u62ec\u53f7\u8981\u6709\u7a7a\u683c\n-ne \u4e24\u6570\u4e0d\u76f8\u7b49\uff0c\u5219\u4e3a\u771f      \u4f8b\uff1a if [\"$a\" -ne \"$b\" ]\n-gt a\u5927\u4e8eb\uff0c\u5219\u4e3a\u771f         \u4f8b\uff1a if [\"$a\" -gt \"$b\" ]\n-ge \u5927\u4e8e\u6216\u7b49\u4e8e\uff0c\u5219\u4e3a\u771f      \u4f8b\uff1a if [\"$a\" -ge \"$b\" ]\n-lt a\u5c0f\u4e8eb\uff0c\u5219\u4e3a\u771f         \u4f8b\uff1a if [\"$a\" -lt \"$b\" ]\n-le a\u5c0f\u4e8e\u6216\u7b49\u4e8eb\uff0c\u5219\u4e3a\u771f    \u4f8b\uff1a if [\"$a\" -le \"$b\" ]\n\n\n\n#\u5224\u65ad\u6587\u4ef6\n\n-e filename \u5982\u679c filename\u5b58\u5728\uff0c\u5219\u4e3a\u771f\n-d filename \u5982\u679c filename\u4e3a\u76ee\u5f55,\u5219\u4e3a\u771f\n-f filename \u5982\u679c filename\u4e3a\u5e38\u89c4\u6587\u4ef6,\u5219\u4e3a\u771f\n-r filename \u5982\u679c filename\u53ef\u8bfb,\u5219\u4e3a\u771f #\u7528\u6237\u4f1a\u6709\u533a\u522b\uff0croot\u7528\u6237\u7684\u60c5\u51b5\u4e0b\u90fd\u4e3a\u771f\uff0c\u56e0\u4e3a\u4ed6\u662fzui'da\n-w filename \u5982\u679c filename\u53ef\u5199\uff0c\u5219\u4e3a\u771f\n-x filename \u5982\u679c filename\u53ef\u6267\u884c\uff0c\u5219\u4e3a\u771f\n-s filename \u5982\u679c\u6587\u4ef6\u957f\u5ea6\u4e0d\u4e3a0\uff0c\u5219\u4e3a\u771f\uff08\u6587\u4ef6\u4e0d\u80fd\u4e3a\u7a7a\uff09\n-h filename \u5982\u679c\u6587\u4ef6\u662f\u8f6f\u94fe\u63a5\uff0c\u5219\u4e3a\u771f\n\n\n#\u5224\u65ad\u5b57\u7b26\u4e32\n== \u6216= \u5224\u65ad\u4fe9\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u76f8\u7b49   #=\u662f==\u7684\u522b\u540d\uff0c\u529f\u80fd\u76f8\u540c\n!= \u5224\u65ad\u4e24\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u4e0d\u76f8\u7b49\n-z \u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a (\u957f\u5ea6\u4e3a0)\n-n \u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u975e\u7a7a (\u957f\u5ea6\u4e0d\u4e3a0)\n&lt; &gt; \u6309\u5b57\u5178\u987a\u5e8f\u6bd4\u8f83\u5b57\u7b26\u4e32\ncase \u8bed\u53e5  \u591a\u6761\u4ef6\u5b57\u7b26\u4e32\u5339\u914d\n\n\u591a\u6761\u4ef6\u5224\u65ad\nand   \u6ee1\u8db3\u6240\u6709\u6761\u4ef6\uff0c\u5219\u4e3a\u771f\n[root@localhost ~]# [ 1 -lt 5 -a 6 -lt 9 ] ; echo $?    # -lt\u662f\u5c0f\u4e8e\n0\n[root@localhost ~]# [ 1 -lt 5 -a 6 -lt 3 ] ; echo $?\n1\n\nor    \u6ee1\u8db3\u5176\u4e2d\u4e00\u4e2a\u6761\u4ef6\uff0c\u5219\u4e3a\u771f\n[root@localhost ~]# [ 1 -lt 2 -o 6 -lt 3  ] ; echo $?\n0\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_6", "title": "\u5224\u65ad\u7ec3\u4e60", "text": "<p>\u5355\\\u53cc\u5206\u652fif\u5224\u65ad</p> <pre><code>[root@localhost ~]# cat useradd.sh \n#!/bin/bash\nread -p \"\u8f93\u5165\u4f60\u8981\u521b\u5efa\u7684\u7528\u6237:\" name\nid $name &amp;&gt; /dev/null\nif [ $? -ne 0  ]; then          # then\u8868\u793a\u4e3a\u771f\u624d\u4f1a\u5904\u7406\u540e\u9762\u7ed3\u679c\n    useradd $name\n    echo \"$name \u521b\u5efa\u6210\u529f\"\nelse                             #\u52a0\u4e86else\u8868\u793a\u53cc\u5206\u652f\n    echo \"$name \u5df2\u7ecf\u5b58\u5728\"\nfi\n</code></pre> <p>\u591a\u5206\u652fif\u5224\u65ad</p> <pre><code>[root@localhost ~]# cat data.sh   #\u5224\u65ad\u5f53\u524d\u65f6\u95f4\u811a\u672c\n#!/bin/bash\nhour=$(date +\"%H\")\n#\u5224\u65ad\u65f6\u95f4\u6bb5\nif [ $hour -ge 0 -a $hour -lt 6 ]; then\n    echo \"\u73b0\u5728\u662f\u51cc\u6668\"\nelif [ $hour -ge 6 -a $hour -lt 12 ]; then\n    echo \"\u73b0\u5728\u662f\u4e0a\u5348\"\nelif [ $hour -ge 12 -a $hour -lt 18 ]; then\n    echo \"\u73b0\u5728\u662f\u4e0b\u5348\"\nelse\n    echo \"\u73b0\u5728\u662f\u665a\u4e0a\"\nfi\n</code></pre> <p>\u5d4c\u5957\u5206\u652f</p> <pre><code>[root@localhost ~]# cat num.sh \n#!/bin/bash\ntarget=10\necho \" \u8fdb\u5165\u731c\u6570\u5b57\u6e38\u620f,\u8bf7\u8f93\u5165\u4e00\u4e2a1-100\u6570\u5b57:\"\nread -p \"\u8bf7\u8f93\u5165\u4f60\u7684\u6570\u5b57:\" guess\n\nif [ \"$guess\" -eq \"$target\"  ]; then\n    echo \"\u606d\u559c\u4f60\uff0c\u731c\u5bf9\u4e86\"\n    num=20\n    read -p \"\u7ee7\u7eed\u731c\u4e00\u4e2a\u6570\u5b57:\" guess\n    if [ \"$guess\" -eq \"$num\" ]; then\n        echo \"\u606d\u559c\u4f60\u731c\u5bf9\u4e86,\u6e38\u620f\u7ed3\u675f,\u8fd9\u662f\u5d4c\u5957\u7684\"\n    else\n        echo \"\u731c\u9519\u4e86\uff0c\u6e38\u620f\u7ed3\u675f,\u8fd9\u662f\u5d4c\u5957\u7684\"\n    fi\nelse\n    echo \"\u731c\u9519\u4e86\uff0c\u6e38\u620f\u7ed3\u675f\"\nfi\n</code></pre> <p>case \u7a7f\u900f</p> <pre><code>[root@localhost ~]# cat case.sh \nread -p \"\u662f\u5426\u8f93\u5165yes or no \" input\n\n#\u4f7f\u7528if\u8bed\u53e5\nif [ \"$input\" = \"yes\" -o   \"$input\" = \"YES\"  ];then    #\u5982\u679c\u9700\u8981\u91cd\u65b0\u5224\u65ad\u5927\u5c0f\u5199\u9700\u8981\u53e6\u52a0-o\n    echo \"\u8f93\u5165\u7684\u662fyes\"\nelif [ \"$input\" = \"no\" ];then\n    echo \"\u8f93\u5165\u7684\u662fno\"\nelse\n    echo \"\u8f93\u5165\u9519\u8bef\"\nfi\n\ncase \"$input\" in\n    \"yes\"|\"YES\"|\"Yes\")                            #\u4f46\u662fcase\u53ef\u4ee5\u76f4\u63a5\u52a0| \u7136\u540e\u5199\u4e0a\u5927\u5199YES\n        echo \"\u4f60\u9009\u62e9\u4e86 yes\"\n        ;;\n   \"no\")\n        echo \"\u4f60\u9009\u62e9\u4e86 no\"\n        ;;\n    *)\n        echo \"\u65e0\u6548\u7684\u9009\u62e9\"\n        ;;\n#sac\n</code></pre> <p>case \u4f8b\u5b50 \u6a21\u62df\u5821\u5792\u673a\u767b\u5f55</p> <pre><code>[root@localhost ~]# cat case.sh \ndb0=192.168.3.100       #\u63d0\u524d\u8bbe\u7f6e\u514d\u5bc6\u767b\u5f55\u4f1a\u5feb\u4e00\u70b9\uff0c\u4e0d\u7136\u767b\u5f55\u7684\u65f6\u5019\u8981\u8f93\u5165\u5bc6\u7801\ndb1=192.168.3.101\ndb2=192.168.3.102\n\ncat &lt;&lt; EOF\n0.\u767b\u5f55db0\n1.\u767b\u5f55db1\n2.\u767b\u5f55db2\nEOF\n\nread -p \"\u8bf7\u8f93\u5165\u8981\u767b\u5f55\u7684\u673a\u5668:\" num\ncase $num in \n0)\nssh root@$db0;;\n1)\nssh root@$db1;;\n2)\nssh root@$db2;;\n*)\necho \"\u672a\u9009\u62e9\u673a\u5668\uff0c\u9000\u51fa\u9009\u62e9\"\nesac\n</code></pre> <p>\u7cfb\u7edf\u5de5\u5177\u7bb1   \u66f4\u6539\u6e90\u5730\u5740\uff0c\u8fd8\u53ef\u4ee5\u7f16\u5199\u5185\u5b58\u786c\u76d8\u4e4b\u7c7b\u7684\u540e\u9762</p> <pre><code>[root@localhost ~]# cat case.sh \n#!/bin/bash\n\necho \"---\u5f00\u59cb\u9009\u62e9\u4e0b\u8f7d\u52a0\u901f\u6e90---\"\ncat &lt;&lt;EOF\n1. \u963f\u91cc\u6e90\n2. \u534e\u4e3a\u6e90\n3. \u6e05\u534e\u6e90\nEOF\n\nread -p \"\u8bf7\u8f93\u5165\u9700\u8981\u914d\u7f6e\u7684\u52a0\u901f\u6e90: \" rep\ncase $rep in\n1)\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n    curl -o /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo\n    echo \"\u963f\u91cc\u6e90\u914d\u7f6e\u5b8c\u6210\"\n    ;;\n2)\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS-7-anon.repo\n    echo \"\u534e\u4e3a\u6e90\u914d\u7f6e\u5b8c\u6210\"\n    ;;\n3)\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.tuna.tsinghua.edu.cn/repo/Centos-7.repo\n    echo \"\u6e05\u534e\u6e90\u914d\u7f6e\u5b8c\u6210\"\n    ;;\n*)\n    echo \"\u672a\u9009\u62e9\u6709\u6548\u7684\u52a0\u901f\u6e90\uff0c\u9000\u51fa\u914d\u7f6e\"\n    exit 1\n    ;;\nesac\n\necho \"---\u8bf7\u8f93\u5165\u4f60\u8981\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u5305\u540d\u5b57---\"\nread -p \"\u8bf7\u8f93\u5165\u8f6f\u4ef6\u540d\u5b57\u5f00\u59cb\u4e0b\u8f7d: \" name\nyum install $name -y    \n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#debug", "title": "debug", "text": "<pre><code>\u8bed\u6cd5:  sh -vx xxxx   xxx\u4e3a\u811a\u672c\u540d\u79f0\n</code></pre> <pre><code>[root@localhost ~]# sh -vx case.sh \n#!/bin/bash\n\necho \"---\u5f00\u59cb\u9009\u62e9\u4e0b\u8f7d\u52a0\u901f\u6e90---\"\n+ echo ---\u5f00\u59cb\u9009\u62e9\u4e0b\u8f7d\u52a0\u901f\u6e90---              #\u51fa\u73b0+\u53f7\u8868\u793a\u5df2\u7ecf\u6210\u529f\u8fd0\u884c\n---\u5f00\u59cb\u9009\u62e9\u4e0b\u8f7d\u52a0\u901f\u6e90---\ncat &lt;&lt;EOF\n1. \u963f\u91cc\u6e90\n2. \u534e\u4e3a\u6e90\n3. \u6e05\u534e\u6e90\nEOF\n+ cat\n1. \u963f\u91cc\u6e90\n2. \u534e\u4e3a\u6e90\n3. \u6e05\u534e\u6e90\n\nread -p \"\u8bf7\u8f93\u5165\u9700\u8981\u914d\u7f6e\u7684\u52a0\u901f\u6e90: \" rep\n+ read -p '\u8bf7\u8f93\u5165\u9700\u8981\u914d\u7f6e\u7684\u52a0\u901f\u6e90: ' rep\n\u8bf7\u8f93\u5165\u9700\u8981\u914d\u7f6e\u7684\u52a0\u901f\u6e90: 1\ncase $rep in\n1)\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n    curl -o /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo\n    echo \"\u963f\u91cc\u6e90\u914d\u7f6e\u5b8c\u6210\"\n    ;;\n2)\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS-7-anon.repo\n    echo \"\u534e\u4e3a\u6e90\u914d\u7f6e\u5b8c\u6210\"\n    ;;\n3)\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.tuna.tsinghua.edu.cn/repo/Centos-7.repo\n    echo \"\u6e05\u534e\u6e90\u914d\u7f6e\u5b8c\u6210\"\n    ;;\n*)\n    echo \"\u672a\u9009\u62e9\u6709\u6548\u7684\u52a0\u901f\u6e90\uff0c\u9000\u51fa\u914d\u7f6e\"\n    exit 1\n    ;;\nesac\n+ case $rep in\n+ curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  2523  100  2523    0     0   9024      0 --:--:-- --:--:-- --:--:--  9043\n+ curl -o /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   664  100   664    0     0   1930      0 --:--:-- --:--:-- --:--:--  1935\n+ echo \u963f\u91cc\u6e90\u914d\u7f6e\u5b8c\u6210\n\u963f\u91cc\u6e90\u914d\u7f6e\u5b8c\u6210\n\necho \"---\u8bf7\u8f93\u5165\u4f60\u8981\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u5305\u540d\u5b57---\"\n+ echo ---\u8bf7\u8f93\u5165\u4f60\u8981\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u5305\u540d\u5b57---\n---\u8bf7\u8f93\u5165\u4f60\u8981\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u5305\u540d\u5b57---\nread -p \"\u8bf7\u8f93\u5165\u8f6f\u4ef6\u540d\u5b57\u5f00\u59cb\u4e0b\u8f7d: \" name\n+ read -p '\u8bf7\u8f93\u5165\u8f6f\u4ef6\u540d\u5b57\u5f00\u59cb\u4e0b\u8f7d: ' name\n\u8bf7\u8f93\u5165\u8f6f\u4ef6\u540d\u5b57\u5f00\u59cb\u4e0b\u8f7d: vim\nyum install $name -y    \n+ yum install vim -y\n\u5df2\u52a0\u8f7d\u63d2\u4ef6\uff1afastestmirror\nLoading mirror speeds from cached hostfile\n * base: mirrors.aliyun.com\n * extras: mirrors.aliyun.com\n * updates: mirrors.aliyun.com\nbase                                                                                                                                               | 3.6 kB  00:00:00     \nepel                                                                                                                                               | 4.3 kB  00:00:00     \nextras                                                                                                                                             | 2.9 kB  00:00:00     \nupdates                                                                                                                                            | 2.9 kB  00:00:00     \n\u8f6f\u4ef6\u5305 2:vim-enhanced-7.4.629-8.el7_9.x86_64 \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u65e0\u987b\u4efb\u4f55\u5904\u7406\n[root@localhost ~]# \n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_7", "title": "\u8fd0\u7ef4\u5e38\u7528\u811a\u672c\u7ec3\u4e60", "text": "<pre><code>#!/bin/bash\n\n# \u8bbe\u7f6e\u9608\u503c\nCPU_THRESHOLD=80\nMEM_THRESHOLD=80\nDISK_THRESHOLD=90\n\n# \u83b7\u53d6 CPU \u4f7f\u7528\u7387\nCPU_USAGE=$(top -bn1 | grep \"Cpu(s)\" | awk '{print $2}' | cut -d'%' -f1)\n\n# \u83b7\u53d6\u5185\u5b58\u4f7f\u7528\u7387\nMEM_USAGE=$(free | grep Mem | awk '{print $3/$2 * 100.0}')\n\n# \u83b7\u53d6\u78c1\u76d8\u4f7f\u7528\u7387\nDISK_USAGE=$(df -h / | awk 'NR==2 {print $5}' | cut -d'%' -f1)\n\n# \u68c0\u67e5 CPU \u4f7f\u7528\u7387\nif (( $(echo \"$CPU_USAGE &gt; $CPU_THRESHOLD\" | bc -l) )); then\n    echo \"CPU \u4f7f\u7528\u7387\u8fc7\u9ad8: $CPU_USAGE%\" | mail -s \"CPU \u544a\u8b66\" admin@example.com\nfi\n\n# \u68c0\u67e5\u5185\u5b58\u4f7f\u7528\u7387\nif (( $(echo \"$MEM_USAGE &gt; $MEM_THRESHOLD\" | bc -l) )); then\n    echo \"\u5185\u5b58\u4f7f\u7528\u7387\u8fc7\u9ad8: $MEM_USAGE%\" | mail -s \"\u5185\u5b58\u544a\u8b66\" admin@example.com\nfi\n\n# \u68c0\u67e5\u78c1\u76d8\u4f7f\u7528\u7387\nif [ \"$DISK_USAGE\" -gt \"$DISK_THRESHOLD\" ]; then\n    echo \"\u78c1\u76d8\u4f7f\u7528\u7387\u8fc7\u9ad8: $DISK_USAGE%\" | mail -s \"\u78c1\u76d8\u544a\u8b66\" admin@example.com\nfi\n</code></pre> <pre><code>#!/bin/bash\n\n# \u65e5\u5fd7\u76ee\u5f55\nLOG_DIR=\"/var/log/myapp\"\n\n# \u4fdd\u7559\u6700\u8fd1 7 \u5929\u7684\u65e5\u5fd7\nfind $LOG_DIR -type f -name \"*.log\" -mtime +7 -exec rm -f {} \\;\n\necho \"\u65e5\u5fd7\u6e05\u7406\u5b8c\u6210\"\n</code></pre> <pre><code>#!/bin/bash\n\n# \u5907\u4efd\u76ee\u5f55\nBACKUP_DIR=\"/backup\"\nSOURCE_DIR=\"/var/www/html\"\n\n# \u5907\u4efd\u6587\u4ef6\u540d\nBACKUP_FILE=\"backup_$(date +%Y%m%d).tar.gz\"\n\n# \u6253\u5305\u5907\u4efd\ntar -czf $BACKUP_DIR/$BACKUP_FILE $SOURCE_DIR\n\necho \"\u5907\u4efd\u5b8c\u6210: $BACKUP_DIR/$BACKUP_FILE\"\n</code></pre> <p>python \u8fde\u63a5\u6570\u636e\u5e93</p> <pre><code>1.\u5b89\u88c5python3\u5f00\u53d1\u73af\u5883\u7684\u4f9d\u8d56\nyum install python3 python3-devel python3-pip\n2.\u901a\u8fc7python\u7684\u5305\u7ba1\u7406\u5de5\u5177\uff0c\u5b89\u88c5\u8fde\u63a5mysql\u7684\u6a21\u5757\npip3 install pymysql -i https://mirrors.aliyun.com/pypi/simple/\n\n#\u5982\u679c\u662fmysql8.0\u7248\u672c\u8fd8\u9700\u8981\u5b89\u88c5cryptography\npip3 install cryptography -i https://mirrors.aliyun.com/pypi/simple/\n\u5f00\u53d1python\u8fde\u63a5mysql\u7684\u4ee3\u7801\uff0c\u6ce8\u610fpython\u7684\u4ee3\u7801\uff0c\u7a7a\u683c\u6570\u91cf\u662f\u4e25\u683c\u628a\u63a7\u7684\n\n\u6570\u636e\u5e93\u8fde\u63a5\u6b63\u786e\uff0c\u8be5\u6570\u636e\u5e93\u7248\u672c\u662f: 8.0.30\n[root@zabbix-server ~]# cat mysql.py \nimport pymysql\n\ndb = pymysql.connect(\n    host=\"localhost\",\n    port=3306,\n    user=\"root\",\n    password=\"Admin123...\",\n    db=\"zabbix\",\n    charset=\"utf8\"\n\n)\n# \u64cd\u7eb5\u6570\u636e\u5e93\ncursor=db.cursor()\ncursor.execute(\"select version()\")\n\ndata=cursor.fetchone()\n\nprint(\"\u6570\u636e\u5e93\u8fde\u63a5\u6b63\u786e\uff0c\u8be5\u6570\u636e\u5e93\u7248\u672c\u662f: %s\"%data)\ndb.close()\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_8", "title": "\u7cfb\u7edf\u76d1\u63a7\u811a\u672c", "text": ""}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_9", "title": "\u65e5\u5fd7\u6e05\u7406\u811a\u672c", "text": ""}, {"location": "%E8%B5%84%E6%96%99/shell%20%E5%AD%A6%E4%B9%A0/#_10", "title": "\u5907\u4efd\u811a\u672c", "text": ""}, {"location": "%E8%B5%84%E6%96%99/%E9%98%BF%E9%87%8C%E4%BA%91yum%E6%BA%90/", "title": "\u5c0f\u8d44\u6599", "text": "<p>\u963f\u91cc\u4e91yum\u6e90</p> <pre><code>[base]\nname=CentOS-$releasever - Base - Aliyun\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/os/$basearch/\ngpgcheck=0\ngpgkey=http://mirrors.aliyun.com/centos/$releasever/os/$basearch/RPM-GPG-KEY-CentOS-7\n\n[updates]\nname=CentOS-$releasever - Updates - Aliyun\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/updates/$basearch/\ngpgcheck=0\ngpgkey=http://mirrors.aliyun.com/centos/$releasever/os/$basearch/RPM-GPG-KEY-CentOS-7\n\n[extras]\nname=CentOS-$releasever - Extras - Aliyun\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/extras/$basearch/\ngpgcheck=0\ngpgkey=http://mirrors.aliyun.com/centos/$releasever/os/$basearch/RPM-GPG-KEY-CentOS-7\n\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch - Aliyun\nbaseurl=http://mirrors.aliyun.com/epel/7/$basearch\nfailovermethod=priority\nenabled=1\ngpgcheck=0\ngpgkey=http://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-7\n</code></pre> <p>\u53ef\u4ee5\u5b9e\u73b0xshell \u5b89\u88c5\u5355\u4e2a\u8f6f\u4ef6 </p> <pre><code>apt install lrzsz\n</code></pre> <p>helm \u4e00\u952e\u5b89\u88c5</p> <pre><code>curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/", "title": "Docker\u642d\u5efa\u57fa\u4e8eNextcloud\u7684\u4e2a\u4eba\u4e91\u76d8/\u79c1\u6709\u4e91\u76d8/\u4e2a\u4eba\u76f8\u518c/\u5bb6\u5eadNAS", "text": ""}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/#nextcloudmysql", "title": "\u62c9\u53d6nextcloud\u955c\u50cf\u548cmysql\u955c\u50cf", "text": "<pre><code>docker pull mysql\ndocker pull nextcloud\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/#docker", "title": "\u521b\u5efadocker\u7f51\u7edc\uff0c\u5141\u8bb8\u5bb9\u5668\u4e4b\u95f4\u8fdb\u884c\u5b89\u5168\u7684\u901a\u4fe1", "text": "<pre><code>docker network create Nextcloud-group\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/#_1", "title": "\u521b\u5efa\u672c\u5730\u6302\u8f7d\u6570\u636e\u5b58\u50a8\u76ee\u5f55\u5e76\u4e14\u542f\u52a8\u5bb9\u5668", "text": "<pre><code>mkdir -p /date/mysql/\nmkdir -p /data/html/\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/#mysql", "title": "\u542f\u52a8mysql", "text": "<pre><code>docker run -d --name mysql  \\\n-v /date/mysql:/var/lib/mysql \\\n-e MYSQL_USER=admin \\\n-e MYSQL_PASSWORD=Password \\\n-e MYSQL_DATABASE=nextcloud \\\n-e MYSQL_ROOT_PASSWORD=Password \\\n-p 3306:3306 \\\n--network Nextcloud-group \\\n--memory=750m \\\n--cpus=0.8 \\\nmysql\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/#nextcloud", "title": "\u542f\u52a8nextcloud", "text": "<pre><code>docker run -d --name nextcloud \\\n-v /data/html:/var/www/html \\\n-p 80:80 \\\n--network Nextcloud-group \\\n--memory=600m \\\n--cpus=0.8 \\\nnextcloud\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/Docker%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8ENextcloud%E7%9A%84%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E4%B8%AA%E4%BA%BA%E7%9B%B8%E5%86%8C%E5%AE%B6%E5%BA%ADNAS/#nextcloud_1", "title": "\u914d\u7f6enextcloud", "text": "<p>\u6d4f\u89c8\u5668\u6253\u5f00 \u670d\u52a1\u5668IP:80</p> <p></p> <p>\u7b49\u5f85\u5b89\u88c5\u540e\u53ef\u4ee5\u9009\u62e9\u8df3\u8fc7</p> <p></p> <p>\u5230\u6b64\u7b97\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210</p> <p></p>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/", "title": "\u4f7f\u7528Docker\u90e8\u7f72Ward\u670d\u52a1\u5668\u76d1\u63a7\u5de5\u5177", "text": ""}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#ward", "title": "Ward\u4ecb\u7ecd", "text": ""}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#ward_1", "title": "Ward\u7b80\u4ecb", "text": "<p>Ward \u76d1\u63a7\u5de5\u5177\u662f\u4e00\u6b3e\u4e13\u95e8\u7528\u4e8e\u76d1\u63a7Linux \u65e5\u7cfb\u7edf\u7684\u5de5\u5177\u3002\u5b83\u53ef\u4ee5\u5b9e\u65f6\u76d1\u6d4b\u7cfb\u7edf\u7684 CPU9\u3001\u5185\u5b58\u3001I/0\u7b49\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u4ee5\u53ca\u7cfb\u7edf\u7684\u7f51\u7edc\u72b6\u6001\u548c\u670d\u52a1\u8fd0\u884c\u72b6\u6001\u7b49\u3002</p>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#ward_2", "title": "Ward\u7279\u70b9", "text": "<p>Ward \u652f\u6301\u81ea\u9002\u5e94\u8bbe\u8ba1\u7cfb\u7edf\u3002 Ward\u8fd8\u652f\u6301\u6df1\u8272\u4e3b\u9898\u3002 Ward\u53ea\u663e\u793a\u670d\u52a1\u5668\u7684\u4e3b\u8981\u4fe1\u606f\u3002 Ward \u5728\u6240\u6709\u6d41\u884c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u8fd0\u884c\u826f\u597d\u3002</p> <p>Ward\u4f7f\u7528\u573a\u666f</p> <pre><code>1.\u6027\u80fd\u76d1\u63a7\u4e0e\u4f18\u5316:\u5728\u5927\u578b\u4f01\u4e1a\u6216\u4e92\u8054\u7f51\u516c\u53f8\u7684\u670d\u52a1\u5668\u96c6\u7fa4\u4e2d\uff0cWard\u76d1\u63a7\u5de5\u5177\u53ef\u4ee5\u6301\u7eed\u76d1\u63a7\u6bcf\u4e00\u53f0Linux\u670d\u52a1\u5668\u7684CPU\u4f7f\u7528\u7387\u3001\u5185\u5b58\u5360\u7528\u3001\u78c1\u76d8I/0\u7b49\u5173\u952e\u6027\u80fd\u6307\u6807\u3002\u5f53\u8fd9\u4e9b\u6307\u6807\u8d85\u8fc7\u9884\u8bbe\u9608\u503c\u65f6\uff0c\u5b83\u80fd\u7acb\u5373\u53d1\u9001\u8b66\u62a5\uff0c\u5e2e\u52a9\u8fd0\u7ef4\u56e2\u961f\u5feb\u901f\u5b9a\u4f4d\u5230\u6027\u80fd\u74f6\u9888\u6240\u5728\uff0c\u53ca\u65f6\u8fdb\u884c\u8c03\u4f18\u6216\u6269\u5bb9\uff0c\u786e\u4fdd\u4e1a\u52a1\u5e73\u7a33\u8fd0\u884c\n\n2.\u6545\u969c\u9884\u8b66\u4e0e\u6392\u67e5:\u5bf9\u4e8e\u9700\u8981\u9ad8\u53ef\u7528\u6027\u53ea\u7684\u5728\u7ebf\u670d\u52a1\uff0c\u5982\u7535\u5b50\u5546\u52a1\u5e73\u53f0\u3001\u91d1\u878d\u4ea4\u6613\u7cfb\u7edf\u7b49\uff0cWard\u80fd\u591f\u5b9e\u65f6)\u76d1\u6d4b\u670d\u52a1\u7684\u72b6\u6001\u548c\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\u3002\u4e00\u65e6\u53d1\u73b0\u670d\u52a1\u5f02\u5e38\u7ec8\u6b62\u3001\u54cd\u5e94\u65f6\u95f4\u8fc7\u957f\u6216\u662f\u7f51\u7edc\u4e2d\u65ad\u7b49\u95ee\u9898\uff0c\u7acb\u5373\u89e6\u53d1\u62a5\u8b66\u673a\u5236\uff0c\u5e2e\u52a9\u8fd0\u7ef4\u4eba\u5458\u8fc5\u901f\u4ecb\u5165\uff0c\u7f29\u77ed\u6545\u969c\u5904\u7406\u65f6\u95f4\uff0c\u51cf\u5c11\u670d\u52a1\u4e2d\u65ad\u5e26\u6765\u7684\u635f\u5931\uff0c\n\n3.\u8d44\u6e90\u5229\u7528\u7387\u5206\u6790:\u5728\u6570\u636e\u4e2d\u5fc3\u6216\u4e91\u73af\u5883\u4e2d\uff0c\u901a\u8fc7Ward\u957f\u671f\u6536\u96c6\u548c\u5206\u6790\u7cfb\u7edf\u8d44\u6e90\u7684\u4f7f\u7528\u6570\u636e\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7ba1\u7406\u5458\u4e86\u89e3\u8d44\u6e90\u7684\u5206\u914d\u548c\u5229\u7528\u6548\u7387\u3002\u8fd9\u5bf9\u4e8e\u5408\u7406\u89c4\u5212\u8d44\u6e90\u3001\u907f\u514d\u8d44\u6e90\u6d6a\u8d39\u3001\u4f18\u5316\u6210\u672c\u7ed3\u6784\u5341\u5206\u5173\u952e\u3002\u4f8b\u5982\u901a\u8fc7\u5206\u6790\u62a5\u544a\u53ef\u4ee5\u51b3\u5b9a\u662f\u5426\u9700\u8981\u8c03\u6574\u865a\u62df\u673a,\u56db\u7684\u914d\u7f6e\uff0c\u6216\u8005\u662f\u5426\u6709\u5fc5\u8981\u5c06\u67d0\u4e9b\u670d\u52a1\u8fc1\u79fb\u5230\u5176\u4ed6\u8d1f\u8f7d\u8f83\u4f4e\u7684\u670d\u52a1\u5668\u4e0a\u3002\n\n4.\u5bb9\u91cf\u89c4\u5212:\u968f\u7740\u4e1a\u52a1\u91cf\u7684\u589e\u957f\uff0c\u63d0\u524d\u9884\u6d4b\u5e76\u51c6\u5907\u8db3\u591f\u7684\u7cfb\u7edf\u8d44\u6e90\u53d8\u5f97\u5c24\u4e3a\u91cd\u8981\u3002Ward\u63d0\u4f9b\u7684\u5386\u53f2\u76d1\u63a7\u6570\u636e\u548c\u8d8b\u52bf\u5206\u6790\u529f\u80fd\uff0c\u80fd\u591f\u5e2e\u52a9\u4f01\u4e1a\u8fdb\u884c\u51c6\u786e\u7684\u5bb9\u91cf\u89c4\u5212\u3002\u901a\u8fc7\u5206\u6790\u9ad8\u5cf0\u671f\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u9884\u6d4b\u672a\u6765\u53ef\u80fd\u9700\u8981\u7684\u8d44\u6e90\u589e\u957f\u91cf\uff0c\u4ece\u800c\u63d0\u524d\u8fdb\u884c\u786c\u4ef6\u5347\u7ea7\u6216\u4e91\u8d44\u6e90\u7684\u6269\u5bb9\uff0c\u786e\u4fdd\u4e1a\u52a1\u7684\u6301\u7eed\u6269\u5c55\u80fd\u529b\u3002\n\n5.\u5b89\u5168\u5ba1\u8ba1\u4e0e\u5408\u89c4\u6027\u68c0\u67e5:\u867d\u7136Ward\u4e3b\u8981\u805a\u7126\u4e8e\u6027\u80fd\u548c\u72b6\u6001\u76d1\u63a7\uff0c\u4f46\u5176\u5bf9\u7cfb\u7edf\u6d3b\u52a8\u7684\u8ddf\u8e2a\u80fd\u529b\u4e5f\u80fd\u8f85\u52a9\u8fdb\u884c\u5b89\u5168\u5ba1\u8ba1\u3002\u4f8b\u5982\uff0c\u901a\u8fc7\u76d1\u63a7\u5f02\u5e38\u7684\u7f51\u7edc\u6d41\u91cf\u3001\u4e0d\u660e\u7684\u7cfb\u7edf\u8bbf\u95ee\u8bb0\u5f55\u7b49\uff0c\u53ef\u4ee5\u53ca\u65e9\u53d1\u73b0\u6f5c\u5728\u7684\u5b89\u5168\u5a01\u80c1\u914d\u5408\u5176\u4ed6\u5b89\u5168\u5de5\u5177\u4e3a\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u63d0\u4f9b\u591a\u4e00\u5c42\u4fdd\u969c\u3002\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#_1", "title": "\u5f00\u59cb\u642d\u5efa", "text": ""}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#dockerdocker-compose", "title": "\u68c0\u67e5docker\u548cdocker compose\u7248\u672c", "text": ""}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#_2", "title": "\u5f00\u542f\u6d41\u91cf\u8f6c\u53d1", "text": "<pre><code>[root@localhost ~]# echo \"net.ipv4.ip_forward=1\" &gt;&gt;  /etc/sysctl.conf\n[root@localhost ~]# systemctl restart network\n[root@localhost ~]# sysctl net.ipv4.ip_forward\nnet.ipv4.ip_forward = 1\n</code></pre>"}, {"location": "%E8%B5%84%E6%96%99/docker%20project/%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Ward%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/#_3", "title": "\u62c9\u53d6\u955c\u50cf", "text": "<pre><code>docker pull ward\n</code></pre> <p>\u4f7f\u7528docker compose \u65b9\u5f0f\u90e8\u7f72</p> <p>ward.yaml</p> <pre><code>[root@localhost ward]# cat ward.yaml \nversion: '3.3'\nservices:\n  run: \n        restart: unless-stopped\n        container_name: ward\n        ports:\n            - '4000:4000'\n        environment:\n            - WARD_ROOT=4000\n            - WARD_THEME=dark\n            - WARD_NAME=leons-server\n        privileged: true\n        image: antonyleons/ward\n</code></pre> <p></p> <p>\u67e5\u770b\u65e5\u5fd7</p> <p></p> <p>\u67e5\u770bweb\u754c\u9762</p> <p>\u8f93\u5165 IP:4000 \u67e5\u770b</p> <p></p>"}]}